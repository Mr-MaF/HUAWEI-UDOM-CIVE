<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Exam System - HUAWEI-UDOM Portal</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
    <style>
         :root {
            --huawei-red: #e62928;
            --huawei-dark-red: #c41e1d;
            --huawei-blue: #1f69aa;
            --huawei-light-blue: #4e93d3;
            --primary: #5D5CDE;
            --primary-dark: #4845B8;
        }
        
        .dark {
            --bg-primary: #1a1a1a;
            --bg-secondary: #2a2a2a;
            --bg-tertiary: #333333;
            --text-primary: #ffffff;
            --text-secondary: #e0e0e0;
            --border-color: #444444;
        }
        
         :root:not(.dark) {
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #e2e8f0;
            --text-primary: #1a202c;
            --text-secondary: #4a5568;
            --border-color: #e2e8f0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }
        
        .sidebar {
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            transition: all 0.3s ease;
            width: 280px;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
        }
        
        .sidebar.collapsed {
            width: 80px;
        }
        
        .sidebar.mobile-hidden {
            transform: translateX(-100%);
        }
        
        .nav-item {
            border-radius: 12px;
            margin-bottom: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }
        
        .nav-item:hover {
            background: var(--bg-tertiary);
            transform: translateX(4px);
        }
        
        .nav-item.active {
            background: linear-gradient(135deg, rgba(230, 41, 40, 0.15), rgba(31, 105, 170, 0.15));
            color: var(--huawei-red);
            border-left: 4px solid var(--huawei-red);
        }
        
        .nav-text {
            transition: all 0.3s ease;
        }
        
        .sidebar.collapsed .nav-text {
            opacity: 0;
            width: 0;
            overflow: hidden;
        }
        
        .main-content {
            transition: all 0.3s ease;
            margin-left: 280px;
        }
        
        .main-content.sidebar-collapsed {
            margin-left: 80px;
        }
        
        .card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary));
            transform: translateY(-1px);
            box-shadow: 0 8px 20px rgba(93, 92, 222, 0.3);
        }
        
        .btn-secondary {
            background: transparent;
            color: var(--huawei-blue);
            border: 2px solid var(--huawei-blue);
            border-radius: 8px;
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .btn-secondary:hover {
            background: var(--huawei-blue);
            color: white;
            transform: translateY(-1px);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .input-field {
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            color: var(--text-primary);
            transition: all 0.3s ease;
            border-radius: 8px;
            padding: 0.75rem;
            font-size: 1rem;
        }
        
        .input-field:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(93, 92, 222, 0.1);
            outline: none;
        }
        
        .track-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .track-computing {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(16, 185, 129, 0.1));
            color: #16a34a;
            border: 1px solid rgba(34, 197, 94, 0.3);
        }
        
        .track-cloud-computing {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(37, 99, 235, 0.1));
            color: #2563eb;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }
        
        .track-networking {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.1), rgba(147, 51, 234, 0.1));
            color: #7c3aed;
            border: 1px solid rgba(168, 85, 247, 0.3);
        }
        
        .exam-timer {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(220, 38, 38, 0.1));
            color: #dc2626;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            border: 2px solid rgba(239, 68, 68, 0.3);
            animation: pulse 2s infinite;
        }
        
        .exam-timer.warning {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.1), rgba(245, 158, 11, 0.1));
            color: #d97706;
            border-color: rgba(251, 191, 36, 0.3);
        }
        
        .exam-timer.critical {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(220, 38, 38, 0.2));
            color: #dc2626;
            border-color: rgba(239, 68, 68, 0.5);
            animation: pulse 1s infinite;
        }
        
        .progress-indicator {
            background: var(--bg-tertiary);
            height: 6px;
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress-fill {
            background: linear-gradient(90deg, var(--primary), var(--huawei-blue));
            height: 100%;
            transition: width 0.3s ease;
        }
        
        .question-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            transition: all 0.3s ease;
        }
        
        .question-card.active {
            border-color: var(--huawei-blue);
            box-shadow: 0 0 0 3px rgba(31, 105, 170, 0.1);
        }
        
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            color: white;
            font-weight: 500;
            z-index: 9999;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        .toast-success {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        
        .toast-error {
            background: linear-gradient(135deg, var(--huawei-red), var(--huawei-dark-red));
        }
        
        .toast-info {
            background: linear-gradient(135deg, var(--huawei-blue), var(--huawei-light-blue));
        }
        
        .toast-warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        
        .notification-panel {
            position: fixed;
            top: 70px;
            right: 20px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            max-height: 60vh;
            overflow-y: auto;
            z-index: 100;
            width: 300px;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }
        
        .notification-panel.show {
            transform: translateX(0);
        }
        
        .notification-item {
            padding: 0.75rem;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            border-left: 4px solid;
            transition: all 0.3s ease;
        }
        
        .notification-item:hover {
            transform: translateX(4px);
        }
        
        .notification-item.exam {
            border-left-color: #7c3aed;
            background: rgba(124, 58, 237, 0.1);
        }
        
        .notification-item.announcement {
            border-left-color: #f59e0b;
            background: rgba(245, 158, 11, 0.1);
        }
        
        .notification-item.result {
            border-left-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }
        
        .exam-mode {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        .exam-mode * {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        .file-upload-area {
            border: 2px dashed var(--border-color);
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .file-upload-area:hover {
            border-color: var(--primary);
            background: rgba(93, 92, 222, 0.05);
        }
        
        .file-upload-area.dragover {
            border-color: var(--primary);
            background: rgba(93, 92, 222, 0.1);
        }
        
        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                top: 0;
                left: 0;
                height: 100vh;
                z-index: 50;
                width: 280px;
            }
            .main-content {
                margin-left: 0;
            }
            .main-content.sidebar-collapsed {
                margin-left: 0;
            }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes pulse {
            0%,
            100% {
                opacity: 1;
            }
            50% {
                opacity: 0.8;
            }
        }
    </style>
</head>

<body>
    <!-- Notification Panel -->
    <div class="notification-panel" id="notificationPanel">
        <h4 class="font-semibold mb-3 text-sm">Notifications</h4>
        <div id="notificationsList">
            <!-- Notifications will be populated here -->
        </div>
        <div class="mt-3 pt-3 border-t border-gray-200 dark:border-gray-700">
            <button class="btn-secondary w-full text-sm py-2" onclick="markAllNotificationsRead()">
                Mark All Read
            </button>
        </div>
    </div>

    <!-- Sidebar -->
    <div class="sidebar fixed top-0 left-0 h-full z-40" id="sidebar">
        <div class="flex flex-col h-full">
            <!-- Logo -->
            <div class="p-6 border-b border-gray-200 dark:border-gray-700">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-gradient-to-br from-red-500 to-blue-600 rounded-full flex items-center justify-center text-white font-bold mr-3 shadow-lg">
                            HU
                        </div>
                        <span class="nav-text text-lg font-bold whitespace-nowrap">Exam System</span>
                    </div>
                    <button class="md:hidden text-gray-500 hover:text-gray-700" id="closeSidebar">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <!-- User Info -->
            <div class="p-4 border-b border-gray-200 dark:border-gray-700">
                <div class="flex items-center">
                    <div class="w-10 h-10 bg-gradient-to-br from-purple-500 to-blue-600 rounded-full flex items-center justify-center text-white font-bold mr-3" id="userAvatar">
                        U
                    </div>
                    <div class="nav-text">
                        <div class="font-semibold" id="userName">User</div>
                        <div class="text-xs text-gray-500" id="userRole">Role</div>
                        <div class="text-xs text-blue-600" id="userTrack">Track</div>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <nav class="flex-1 p-4 overflow-y-auto">
                <!-- Student Navigation -->
                <div id="studentNav" class="hidden">
                    <div class="mb-4 text-xs font-semibold text-gray-500 uppercase tracking-wider nav-text">Examinations</div>
                    <ul class="space-y-2">
                        <li>
                            <div class="nav-item active flex items-center px-4 py-3" data-section="available-exams">
                                <i class="fas fa-clipboard-list w-5 h-5 mr-3 flex-shrink-0"></i>
                                <span class="nav-text">Available Exams</span>
                                <span class="nav-badge ml-auto bg-red-500 text-white text-xs px-2 py-1 rounded-full nav-text" id="availableExamsCount">0</span>
                            </div>
                        </li>
                        <li>
                            <div class="nav-item flex items-center px-4 py-3" data-section="exam-results">
                                <i class="fas fa-chart-bar w-5 h-5 mr-3 flex-shrink-0"></i>
                                <span class="nav-text">My Results</span>
                            </div>
                        </li>
                        <li>
                            <div class="nav-item flex items-center px-4 py-3" data-section="exam-history">
                                <i class="fas fa-history w-5 h-5 mr-3 flex-shrink-0"></i>
                                <span class="nav-text">Exam History</span>
                            </div>
                        </li>
                        <li>
                            <div class="nav-item flex items-center px-4 py-3" data-section="practice-tests">
                                <i class="fas fa-dumbbell w-5 h-5 mr-3 flex-shrink-0"></i>
                                <span class="nav-text">Practice Tests</span>
                            </div>
                        </li>
                    </ul>
                </div>

                <!-- Expert Navigation -->
                <div id="expertNav" class="hidden">
                    <div class="mb-4 text-xs font-semibold text-gray-500 uppercase tracking-wider nav-text">Exam Management</div>
                    <ul class="space-y-2">
                        <li>
                            <div class="nav-item active flex items-center px-4 py-3" data-section="exam-dashboard">
                                <i class="fas fa-tachometer-alt w-5 h-5 mr-3 flex-shrink-0"></i>
                                <span class="nav-text">Dashboard</span>
                            </div>
                        </li>
                        <li>
                            <div class="nav-item flex items-center px-4 py-3" data-section="create-exam">
                                <i class="fas fa-plus-circle w-5 h-5 mr-3 flex-shrink-0"></i>
                                <span class="nav-text">Create Exam</span>
                            </div>
                        </li>
                        <li>
                            <div class="nav-item flex items-center px-4 py-3" data-section="manage-exams">
                                <i class="fas fa-edit w-5 h-5 mr-3 flex-shrink-0"></i>
                                <span class="nav-text">Manage Exams</span>
                                <span class="nav-badge ml-auto bg-blue-500 text-white text-xs px-2 py-1 rounded-full nav-text" id="activeExamsCount">0</span>
                            </div>
                        </li>
                        <li>
                            <div class="nav-item flex items-center px-4 py-3" data-section="grade-exams">
                                <i class="fas fa-marker w-5 h-5 mr-3 flex-shrink-0"></i>
                                <span class="nav-text">Grade Exams</span>
                                <span class="nav-badge ml-auto bg-orange-500 text-white text-xs px-2 py-1 rounded-full nav-text" id="pendingGradingCount">0</span>
                            </div>
                        </li>
                        <li>
                            <div class="nav-item flex items-center px-4 py-3" data-section="exam-analytics">
                                <i class="fas fa-chart-line w-5 h-5 mr-3 flex-shrink-0"></i>
                                <span class="nav-text">Exam Analytics</span>
                            </div>
                        </li>
                        <li>
                            <div class="nav-item flex items-center px-4 py-3" data-section="materials-upload">
                                <i class="fas fa-upload w-5 h-5 mr-3 flex-shrink-0"></i>
                                <span class="nav-text">Upload Materials</span>
                            </div>
                        </li>
                    </ul>
                </div>

                <!-- Administrator Navigation -->
                <div id="adminNav" class="hidden">
                    <div class="mb-4 text-xs font-semibold text-gray-500 uppercase tracking-wider nav-text">System Control</div>
                    <ul class="space-y-2">
                        <li>
                            <div class="nav-item active flex items-center px-4 py-3" data-section="admin-dashboard">
                                <i class="fas fa-shield-alt w-5 h-5 mr-3 flex-shrink-0"></i>
                                <span class="nav-text">Admin Console</span>
                            </div>
                        </li>
                        <li>
                            <div class="nav-item flex items-center px-4 py-3" data-section="live-monitoring">
                                <i class="fas fa-eye w-5 h-5 mr-3 flex-shrink-0"></i>
                                <span class="nav-text">Live Monitoring</span>
                                <span class="nav-badge ml-auto bg-green-500 text-white text-xs px-2 py-1 rounded-full nav-text" id="liveExamsCount">0</span>
                            </div>
                        </li>
                        <li>
                            <div class="nav-item flex items-center px-4 py-3" data-section="ai-proctoring">
                                <i class="fas fa-robot w-5 h-5 mr-3 flex-shrink-0"></i>
                                <span class="nav-text">AI Proctoring</span>
                            </div>
                        </li>
                        <li>
                            <div class="nav-item flex items-center px-4 py-3" data-section="system-analytics">
                                <i class="fas fa-chart-area w-5 h-5 mr-3 flex-shrink-0"></i>
                                <span class="nav-text">System Analytics</span>
                            </div>
                        </li>
                        <li>
                            <div class="nav-item flex items-center px-4 py-3" data-section="announcements">
                                <i class="fas fa-bullhorn w-5 h-5 mr-3 flex-shrink-0"></i>
                                <span class="nav-text">Announcements</span>
                            </div>
                        </li>
                    </ul>
                </div>

                <!-- Common sections -->
                <div class="my-4 text-xs font-semibold text-gray-500 uppercase tracking-wider nav-text">Communication</div>
                <ul class="space-y-2">
                    <li>
                        <div class="nav-item flex items-center px-4 py-3" data-section="notifications">
                            <i class="fas fa-bell w-5 h-5 mr-3 flex-shrink-0"></i>
                            <span class="nav-text">Notifications</span>
                            <span class="nav-badge ml-auto bg-red-500 text-white text-xs px-2 py-1 rounded-full nav-text" id="notificationCount">0</span>
                        </div>
                    </li>
                    <li>
                        <div class="nav-item flex items-center px-4 py-3" data-section="issues">
                            <i class="fas fa-exclamation-triangle w-5 h-5 mr-3 flex-shrink-0"></i>
                            <span class="nav-text">Report Issues</span>
                        </div>
                    </li>
                </ul>
            </nav>

            <!-- Back to Dashboard -->
            <div class="p-4 border-t border-gray-200 dark:border-gray-700">
                <button class="w-full flex items-center justify-center px-4 py-2 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900 rounded-lg transition-colors" id="backToDashboard">
                    <i class="fas fa-home mr-2"></i>
                    <span class="nav-text">Main Dashboard</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content" id="mainContent">
        <!-- Top Header -->
        <header class="bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700 sticky top-0 z-30">
            <div class="flex items-center justify-between p-4">
                <div class="flex items-center">
                    <button class="md:hidden mr-4 text-gray-600 hover:text-gray-800" id="openSidebar">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                    <button class="hidden md:block mr-4 text-gray-600 hover:text-gray-800" id="toggleSidebar">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                    <div>
                        <h1 class="text-2xl font-bold" id="headerTitle">Advanced Exam System</h1>
                        <p class="text-sm text-gray-500" id="headerSubtitle">AI-Powered examination platform with blockchain verification</p>
                    </div>
                </div>

                <div class="flex items-center space-x-4">
                    <!-- Exam Timer (visible during exam) -->
                    <div class="exam-timer hidden" id="examTimer">
                        <i class="fas fa-clock mr-2"></i>
                        <span id="timeRemaining">00:00:00</span>
                    </div>

                    <button class="p-2 text-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg relative" id="notificationBtn">
                        <i class="fas fa-bell"></i>
                        <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full min-w-[20px] h-5 flex items-center justify-center" id="notificationBadge">0</span>
                    </button>

                    <button class="p-2 text-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg" id="darkModeToggle">
                        <i class="fas fa-moon" id="darkModeIcon"></i>
                    </button>

                    <button class="p-2 text-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg" id="fullscreenToggle">
                        <i class="fas fa-expand" id="fullscreenIcon"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="p-6" id="mainContentArea">
            <!-- Student: Available Exams Section -->
            <div id="available-exams-section" class="section fade-in">
                <div class="card p-6">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h2 class="text-2xl font-bold">Available Examinations</h2>
                            <p class="text-gray-600 dark:text-gray-400">Track-specific examinations with AI proctoring</p>
                        </div>
                        <div class="flex space-x-3">
                            <select class="input-field" id="trackFilter">
                                <option value="all">All Tracks</option>
                                <option value="computing">Computing</option>
                                <option value="cloud-computing">Cloud Computing</option>
                                <option value="networking">Networking</option>
                            </select>
                            <button class="btn-secondary" onclick="refreshAvailableExams()">
                                <i class="fas fa-sync-alt mr-2"></i>Refresh
                            </button>
                        </div>
                    </div>

                    <!-- System Requirements -->
                    <div class="card p-4 mb-6 bg-blue-50 dark:bg-blue-900 border-blue-200 dark:border-blue-800">
                        <h3 class="font-semibold mb-3 text-blue-800 dark:text-blue-200">System Requirements Check</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="flex items-center">
                                <i class="fas fa-video text-green-600 mr-2"></i>
                                <span class="text-sm">Camera Access: <span class="font-semibold text-green-600">Ready</span></span>
                            </div>
                            <div class="flex items-center">
                                <i class="fas fa-microphone text-green-600 mr-2"></i>
                                <span class="text-sm">Microphone: <span class="font-semibold text-green-600">Ready</span></span>
                            </div>
                            <div class="flex items-center">
                                <i class="fas fa-wifi text-green-600 mr-2"></i>
                                <span class="text-sm">Internet: <span class="font-semibold text-green-600">Stable</span></span>
                            </div>
                        </div>
                    </div>

                    <!-- Available Exams List -->
                    <div id="availableExamsList" class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Exams will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Student: Exam Results Section -->
            <div id="exam-results-section" class="section hidden fade-in">
                <div class="card p-6">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h2 class="text-2xl font-bold">My Exam Results</h2>
                            <p class="text-gray-600 dark:text-gray-400">View your examination results and performance analytics</p>
                        </div>
                        <div class="flex space-x-3">
                            <select class="input-field" id="resultsFilter">
                                <option value="all">All Results</option>
                                <option value="recent">Recent</option>
                                <option value="passed">Passed</option>
                                <option value="failed">Failed</option>
                            </select>
                        </div>
                    </div>

                    <!-- Results Summary -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <div class="card p-4 text-center">
                            <div class="text-2xl font-bold text-blue-600" id="totalExamsTaken">0</div>
                            <div class="text-sm text-gray-500">Total Exams</div>
                        </div>
                        <div class="card p-4 text-center">
                            <div class="text-2xl font-bold text-green-600" id="averageScore">0%</div>
                            <div class="text-sm text-gray-500">Average Score</div>
                        </div>
                        <div class="card p-4 text-center">
                            <div class="text-2xl font-bold text-purple-600" id="highestScore">0%</div>
                            <div class="text-sm text-gray-500">Highest Score</div>
                        </div>
                        <div class="card p-4 text-center">
                            <div class="text-2xl font-bold text-orange-600" id="passRate">0%</div>
                            <div class="text-sm text-gray-500">Pass Rate</div>
                        </div>
                    </div>

                    <!-- Results List -->
                    <div id="examResultsList">
                        <!-- Results will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Student: Exam History Section -->
            <div id="exam-history-section" class="section hidden fade-in">
                <div class="card p-6">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h2 class="text-2xl font-bold">Exam History</h2>
                            <p class="text-gray-600 dark:text-gray-400">Complete history of all your examinations</p>
                        </div>
                        <div class="flex space-x-3">
                            <input type="date" class="input-field" id="historyDateFilter">
                            <button class="btn-secondary" onclick="exportHistory()">
                                <i class="fas fa-download mr-2"></i>Export
                            </button>
                        </div>
                    </div>

                    <div id="examHistoryList">
                        <!-- History will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Student: Practice Tests Section -->
            <div id="practice-tests-section" class="section hidden fade-in">
                <div class="card p-6">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h2 class="text-2xl font-bold">Practice Tests</h2>
                            <p class="text-gray-600 dark:text-gray-400">Prepare for exams with practice sessions</p>
                        </div>
                        <div class="flex space-x-3">
                            <select class="input-field" id="practiceTrackFilter">
                                <option value="all">All Tracks</option>
                                <option value="computing">Computing</option>
                                <option value="cloud-computing">Cloud Computing</option>
                                <option value="networking">Networking</option>
                            </select>
                        </div>
                    </div>

                    <div id="practiceTestsList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Practice tests will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Expert Dashboard Section -->
            <div id="exam-dashboard-section" class="section hidden fade-in">
                <div class="card p-6">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h2 class="text-2xl font-bold">Expert Dashboard</h2>
                            <p class="text-gray-600 dark:text-gray-400">Manage exams, grading, and analytics</p>
                        </div>
                        <div class="flex space-x-3">
                            <button class="btn-primary" onclick="showSection('create-exam')">
                                <i class="fas fa-plus mr-2"></i>Create New Exam
                            </button>
                        </div>
                    </div>

                    <!-- Quick Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <div class="card p-6 text-center">
                            <div class="w-16 h-16 bg-blue-100 dark:bg-blue-900 rounded-xl flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-clipboard-list text-2xl text-blue-600"></i>
                            </div>
                            <h4 class="font-semibold text-lg mb-2" id="expertActiveExams">0</h4>
                            <p class="text-gray-600 dark:text-gray-400 text-sm">Active Exams</p>
                        </div>

                        <div class="card p-6 text-center">
                            <div class="w-16 h-16 bg-orange-100 dark:bg-orange-900 rounded-xl flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-marker text-2xl text-orange-600"></i>
                            </div>
                            <h4 class="font-semibold text-lg mb-2" id="expertPendingGrading">0</h4>
                            <p class="text-gray-600 dark:text-gray-400 text-sm">Pending Grading</p>
                        </div>

                        <div class="card p-6 text-center">
                            <div class="w-16 h-16 bg-green-100 dark:bg-green-900 rounded-xl flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-chart-line text-2xl text-green-600"></i>
                            </div>
                            <h4 class="font-semibold text-lg mb-2" id="expertAvgScore">0%</h4>
                            <p class="text-gray-600 dark:text-gray-400 text-sm">Average Score</p>
                        </div>

                        <div class="card p-6 text-center">
                            <div class="w-16 h-16 bg-purple-100 dark:bg-purple-900 rounded-xl flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-users text-2xl text-purple-600"></i>
                            </div>
                            <h4 class="font-semibold text-lg mb-2" id="expertTotalStudents">0</h4>
                            <p class="text-gray-600 dark:text-gray-400 text-sm">Total Students</p>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div>
                            <h3 class="text-lg font-semibold mb-4">Recent Exams</h3>
                            <div id="expertRecentExams" class="space-y-3">
                                <!-- Recent exams will be populated here -->
                            </div>
                        </div>

                        <div>
                            <h3 class="text-lg font-semibold mb-4">Quick Actions</h3>
                            <div class="space-y-3">
                                <button class="w-full flex items-center p-4 card hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors" onclick="showSection('create-exam')">
                                    <i class="fas fa-plus-circle text-blue-600 text-xl mr-4"></i>
                                    <div class="text-left">
                                        <h4 class="font-semibold">Create New Exam</h4>
                                        <p class="text-sm text-gray-600">Design and publish a new examination</p>
                                    </div>
                                </button>
                                <button class="w-full flex items-center p-4 card hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors" onclick="showSection('grade-exams')">
                                    <i class="fas fa-marker text-orange-600 text-xl mr-4"></i>
                                    <div class="text-left">
                                        <h4 class="font-semibold">Grade Submissions</h4>
                                        <p class="text-sm text-gray-600">Review and grade student answers</p>
                                    </div>
                                </button>
                                <button class="w-full flex items-center p-4 card hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors" onclick="showSection('exam-analytics')">
                                    <i class="fas fa-chart-line text-green-600 text-xl mr-4"></i>
                                    <div class="text-left">
                                        <h4 class="font-semibold">View Analytics</h4>
                                        <p class="text-sm text-gray-600">Analyze exam performance and results</p>
                                    </div>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Expert: Create Exam Section -->
            <div id="create-exam-section" class="section hidden fade-in">
                <div class="card p-6">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h2 class="text-2xl font-bold">Create Advanced Exam</h2>
                            <p class="text-gray-600 dark:text-gray-400">Design comprehensive examinations with AI proctoring</p>
                        </div>
                        <div class="flex space-x-3">
                            <button class="btn-secondary" onclick="saveExamDraft()">
                                <i class="fas fa-save mr-2"></i>Save Draft
                            </button>
                            <button class="btn-primary" onclick="previewExam()">
                                <i class="fas fa-eye mr-2"></i>Preview
                            </button>
                        </div>
                    </div>

                    <form id="createExamForm" class="space-y-6">
                        <!-- Basic Information -->
                        <div class="card p-6">
                            <h3 class="text-lg font-semibold mb-4">Basic Information</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium mb-2">Exam Title *</label>
                                    <input type="text" class="input-field w-full" id="examTitle" placeholder="Enter exam title" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">Track *</label>
                                    <select class="input-field w-full" id="examTrack" required>
                                        <option value="">Select Track</option>
                                        <option value="computing">Computing</option>
                                        <option value="cloud-computing">Cloud Computing</option>
                                        <option value="networking">Networking</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">Duration (minutes) *</label>
                                    <input type="number" class="input-field w-full" id="examDuration" placeholder="120" min="15" max="300" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">Total Marks *</label>
                                    <input type="number" class="input-field w-full" id="examMarks" placeholder="100" min="10" max="500" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">Start Date & Time *</label>
                                    <input type="datetime-local" class="input-field w-full" id="examStartDate" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">End Date & Time *</label>
                                    <input type="datetime-local" class="input-field w-full" id="examEndDate" required>
                                </div>
                            </div>
                            <div class="mt-4">
                                <label class="block text-sm font-medium mb-2">Instructions</label>
                                <textarea class="input-field w-full" id="examInstructions" rows="4" placeholder="Enter exam instructions for students"></textarea>
                            </div>
                        </div>

                        <!-- Questions Section -->
                        <div class="card p-6">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-lg font-semibold">Questions</h3>
                                <button type="button" class="btn-primary" onclick="addQuestion()">
                                    <i class="fas fa-plus mr-2"></i>Add Question
                                </button>
                            </div>
                            <div id="questionsContainer">
                                <!-- Questions will be added here -->
                            </div>
                        </div>

                        <!-- Settings -->
                        <div class="card p-6">
                            <h3 class="text-lg font-semibold mb-4">Exam Settings</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="flex items-center space-x-3">
                                        <input type="checkbox" id="enableAIProcotring" checked class="w-5 h-5 text-blue-600">
                                        <span class="text-sm">Enable AI Proctoring</span>
                                    </label>
                                </div>
                                <div>
                                    <label class="flex items-center space-x-3">
                                        <input type="checkbox" id="enableBlockchain" checked class="w-5 h-5 text-blue-600">
                                        <span class="text-sm">Blockchain Verification</span>
                                    </label>
                                </div>
                                <div>
                                    <label class="flex items-center space-x-3">
                                        <input type="checkbox" id="shuffleQuestions" class="w-5 h-5 text-blue-600">
                                        <span class="text-sm">Shuffle Questions</span>
                                    </label>
                                </div>
                                <div>
                                    <label class="flex items-center space-x-3">
                                        <input type="checkbox" id="allowRetake" class="w-5 h-5 text-blue-600">
                                        <span class="text-sm">Allow Retake</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="flex justify-end space-x-3">
                            <button type="button" class="btn-secondary" onclick="resetForm()">Reset</button>
                            <button type="submit" class="btn-primary">
                                <i class="fas fa-rocket mr-2"></i>Publish Exam
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Expert: Manage Exams Section -->
            <div id="manage-exams-section" class="section hidden fade-in">
                <div class="card p-6">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h2 class="text-2xl font-bold">Manage Exams</h2>
                            <p class="text-gray-600 dark:text-gray-400">Edit, monitor, and control your examinations</p>
                        </div>
                        <div class="flex space-x-3">
                            <select class="input-field" id="examStatusFilter">
                                <option value="all">All Status</option>
                                <option value="draft">Draft</option>
                                <option value="active">Active</option>
                                <option value="completed">Completed</option>
                            </select>
                        </div>
                    </div>

                    <div id="manageExamsList">
                        <!-- Exams will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Expert: Grade Exams Section -->
            <div id="grade-exams-section" class="section hidden fade-in">
                <div class="card p-6">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h2 class="text-2xl font-bold">Grade Exams</h2>
                            <p class="text-gray-600 dark:text-gray-400">Review and grade student submissions</p>
                        </div>
                        <div class="flex space-x-3">
                            <select class="input-field" id="gradingFilter">
                                <option value="pending">Pending</option>
                                <option value="completed">Completed</option>
                                <option value="all">All Submissions</option>
                            </select>
                            <button class="btn-primary" onclick="enableAIGrading()">
                                <i class="fas fa-robot mr-2"></i>AI Grading
                            </button>
                        </div>
                    </div>

                    <div id="gradingList">
                        <!-- Submissions will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Expert: Exam Analytics Section -->
            <div id="exam-analytics-section" class="section hidden fade-in">
                <div class="card p-6">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h2 class="text-2xl font-bold">Exam Analytics</h2>
                            <p class="text-gray-600 dark:text-gray-400">Detailed performance analytics and insights</p>
                        </div>
                        <div class="flex space-x-3">
                            <select class="input-field" id="analyticsExamSelect">
                                <option value="">Select Exam</option>
                            </select>
                            <button class="btn-secondary" onclick="exportAnalytics()">
                                <i class="fas fa-download mr-2"></i>Export
                            </button>
                        </div>
                    </div>

                    <div id="analyticsContent">
                        <!-- Analytics content will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Expert: Materials Upload Section -->
            <div id="materials-upload-section" class="section hidden fade-in">
                <div class="card p-6">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h2 class="text-2xl font-bold">Upload Study Materials</h2>
                            <p class="text-gray-600 dark:text-gray-400">Share study materials and resources with students</p>
                        </div>
                    </div>

                    <!-- Upload Area -->
                    <div class="file-upload-area mb-6" id="fileUploadArea">
                        <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
                        <h3 class="text-lg font-semibold mb-2">Drop files here or click to upload</h3>
                        <p class="text-gray-500">Supported formats: PDF, DOC, DOCX, PPT, PPTX (Max 50MB)</p>
                        <input type="file" id="fileInput" multiple accept=".pdf,.doc,.docx,.ppt,.pptx" class="hidden">
                    </div>

                    <!-- Upload Form -->
                    <div class="card p-6 mb-6">
                        <h3 class="text-lg font-semibold mb-4">Material Information</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium mb-2">Title *</label>
                                <input type="text" class="input-field w-full" id="materialTitle" placeholder="Material title">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Track *</label>
                                <select class="input-field w-full" id="materialTrack">
                                    <option value="">Select Track</option>
                                    <option value="computing">Computing</option>
                                    <option value="cloud-computing">Cloud Computing</option>
                                    <option value="networking">Networking</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Type *</label>
                                <select class="input-field w-full" id="materialType">
                                    <option value="">Select Type</option>
                                    <option value="study-guide">Study Guide</option>
                                    <option value="presentation">Presentation</option>
                                    <option value="assignment">Assignment</option>
                                    <option value="reference">Reference Material</option>
                                </select>
                            </div>
                        </div>
                        <div class="mt-4">
                            <label class="block text-sm font-medium mb-2">Description</label>
                            <textarea class="input-field w-full" id="materialDescription" rows="3" placeholder="Brief description of the material"></textarea>
                        </div>
                        <div class="mt-4 flex justify-end">
                            <button class="btn-primary" onclick="uploadMaterial()">
                                <i class="fas fa-upload mr-2"></i>Upload Material
                            </button>
                        </div>
                    </div>

                    <!-- Uploaded Materials -->
                    <div id="uploadedMaterialsList">
                        <!-- Materials will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Admin Dashboard Section -->
            <div id="admin-dashboard-section" class="section hidden fade-in">
                <div class="card p-6">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h2 class="text-2xl font-bold">Administrator Console</h2>
                            <p class="text-gray-600 dark:text-gray-400">System control and monitoring center</p>
                        </div>
                        <div class="flex space-x-3">
                            <button class="btn-primary" onclick="showSection('ai-proctoring')">
                                <i class="fas fa-robot mr-2"></i>AI Proctoring
                            </button>
                        </div>
                    </div>

                    <!-- System Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <div class="card p-6 text-center">
                            <div class="w-16 h-16 bg-blue-100 dark:bg-blue-900 rounded-xl flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-eye text-2xl text-blue-600"></i>
                            </div>
                            <h4 class="font-semibold text-lg mb-2" id="adminActiveSessions">0</h4>
                            <p class="text-gray-600 dark:text-gray-400 text-sm">Active Sessions</p>
                        </div>

                        <div class="card p-6 text-center">
                            <div class="w-16 h-16 bg-red-100 dark:bg-red-900 rounded-xl flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-exclamation-triangle text-2xl text-red-600"></i>
                            </div>
                            <h4 class="font-semibold text-lg mb-2" id="adminSecurityAlerts">0</h4>
                            <p class="text-gray-600 dark:text-gray-400 text-sm">Security Alerts</p>
                        </div>

                        <div class="card p-6 text-center">
                            <div class="w-16 h-16 bg-green-100 dark:bg-green-900 rounded-xl flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-server text-2xl text-green-600"></i>
                            </div>
                            <h4 class="font-semibold text-lg mb-2" id="adminSystemHealth">100%</h4>
                            <p class="text-gray-600 dark:text-gray-400 text-sm">System Health</p>
                        </div>

                        <div class="card p-6 text-center">
                            <div class="w-16 h-16 bg-purple-100 dark:bg-purple-900 rounded-xl flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-user-shield text-2xl text-purple-600"></i>
                            </div>
                            <h4 class="font-semibold text-lg mb-2" id="adminTotalUsers">0</h4>
                            <p class="text-gray-600 dark:text-gray-400 text-sm">Total Users</p>
                        </div>
                    </div>

                    <!-- System Overview -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div>
                            <h3 class="text-lg font-semibold mb-4">System Status</h3>
                            <div class="space-y-4">
                                <div class="flex justify-between items-center p-4 card">
                                    <div class="flex items-center">
                                        <i class="fas fa-database text-blue-600 text-xl mr-4"></i>
                                        <div>
                                            <h4 class="font-semibold">Database</h4>
                                            <p class="text-sm text-gray-600">Operational</p>
                                        </div>
                                    </div>
                                    <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium">Online</span>
                                </div>
                                <div class="flex justify-between items-center p-4 card">
                                    <div class="flex items-center">
                                        <i class="fas fa-robot text-purple-600 text-xl mr-4"></i>
                                        <div>
                                            <h4 class="font-semibold">AI Proctoring</h4>
                                            <p class="text-sm text-gray-600">Active monitoring</p>
                                        </div>
                                    </div>
                                    <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium">Online</span>
                                </div>
                                <div class="flex justify-between items-center p-4 card">
                                    <div class="flex items-center">
                                        <i class="fas fa-shield-alt text-green-600 text-xl mr-4"></i>
                                        <div>
                                            <h4 class="font-semibold">Security System</h4>
                                            <p class="text-sm text-gray-600">All systems secure</p>
                                        </div>
                                    </div>
                                    <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium">Secure</span>
                                </div>
                            </div>
                        </div>

                        <div>
                            <h3 class="text-lg font-semibold mb-4">Quick Actions</h3>
                            <div class="space-y-3">
                                <button class="w-full flex items-center p-4 card hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors" onclick="showSection('ai-proctoring')">
                                    <i class="fas fa-robot text-purple-600 text-xl mr-4"></i>
                                    <div class="text-left">
                                        <h4 class="font-semibold">AI Proctoring</h4>
                                        <p class="text-sm text-gray-600">Monitor live exam sessions</p>
                                    </div>
                                </button>
                                <button class="w-full flex items-center p-4 card hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors" onclick="showSection('live-monitoring')">
                                    <i class="fas fa-eye text-blue-600 text-xl mr-4"></i>
                                    <div class="text-left">
                                        <h4 class="font-semibold">Live Monitoring</h4>
                                        <p class="text-sm text-gray-600">Real-time system monitoring</p>
                                    </div>
                                </button>
                                <button class="w-full flex items-center p-4 card hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors" onclick="showSection('system-analytics')">
                                    <i class="fas fa-chart-area text-green-600 text-xl mr-4"></i>
                                    <div class="text-left">
                                        <h4 class="font-semibold">System Analytics</h4>
                                        <p class="text-sm text-gray-600">Performance and usage analytics</p>
                                    </div>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Admin: Live Monitoring Section -->
            <div id="live-monitoring-section" class="section hidden fade-in">
                <div class="card p-6">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h2 class="text-2xl font-bold">Live System Monitoring</h2>
                            <p class="text-gray-600 dark:text-gray-400">Real-time monitoring of all system activities</p>
                        </div>
                        <div class="flex space-x-3">
                            <div class="px-4 py-2 bg-green-100 dark:bg-green-900 rounded-lg border border-green-200 dark:border-green-800">
                                <span class="text-sm font-medium text-green-800 dark:text-green-200">
                                    <i class="fas fa-circle text-green-500 mr-2"></i>All Systems Operational
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- Monitoring Dashboard -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div>
                            <h3 class="text-lg font-semibold mb-4">Active Exam Sessions</h3>
                            <div id="activeSessionsList" class="space-y-3">
                                <!-- Active sessions will be populated here -->
                            </div>
                        </div>

                        <div>
                            <h3 class="text-lg font-semibold mb-4">System Performance</h3>
                            <div class="space-y-4">
                                <div class="card p-4">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="font-medium">CPU Usage</span>
                                        <span class="text-sm font-semibold" id="cpuUsage">24%</span>
                                    </div>
                                    <div class="progress-indicator">
                                        <div class="progress-fill" style="width: 24%"></div>
                                    </div>
                                </div>
                                <div class="card p-4">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="font-medium">Memory Usage</span>
                                        <span class="text-sm font-semibold" id="memoryUsage">62%</span>
                                    </div>
                                    <div class="progress-indicator">
                                        <div class="progress-fill" style="width: 62%"></div>
                                    </div>
                                </div>
                                <div class="card p-4">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="font-medium">Network Traffic</span>
                                        <span class="text-sm font-semibold" id="networkTraffic">1.2 Gbps</span>
                                    </div>
                                    <div class="progress-indicator">
                                        <div class="progress-fill" style="width: 45%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Admin: AI Proctoring Section -->
            <div id="ai-proctoring-section" class="section hidden fade-in">
                <div class="card p-6">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h2 class="text-2xl font-bold">AI Proctoring Control</h2>
                            <p class="text-gray-600 dark:text-gray-400">Monitor and control AI proctoring systems</p>
                        </div>
                        <div class="flex space-x-3">
                            <button class="btn-primary" onclick="toggleAIProctoring()">
                                <i class="fas fa-robot mr-2"></i>AI Status: <span id="aiStatus">Active</span>
                            </button>
                        </div>
                    </div>

                    <!-- AI Statistics -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <div class="card p-4 text-center">
                            <div class="text-2xl font-bold text-blue-600" id="monitoriingSessions">12</div>
                            <div class="text-sm text-gray-500">Active Monitoring</div>
                        </div>
                        <div class="card p-4 text-center">
                            <div class="text-2xl font-bold text-red-600" id="securityViolations">3</div>
                            <div class="text-sm text-gray-500">Security Alerts</div>
                        </div>
                        <div class="card p-4 text-center">
                            <div class="text-2xl font-bold text-green-600" id="aiAccuracy">98.7%</div>
                            <div class="text-sm text-gray-500">AI Accuracy</div>
                        </div>
                        <div class="card p-4 text-center">
                            <div class="text-2xl font-bold text-purple-600" id="totalDetections">47</div>
                            <div class="text-sm text-gray-500">Total Detections</div>
                        </div>
                    </div>

                    <!-- Live AI Monitoring -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div>
                            <h3 class="text-lg font-semibold mb-4">Live AI Detections</h3>
                            <div id="aiDetectionsList" class="space-y-3">
                                <!-- AI detections will be populated here -->
                            </div>
                        </div>

                        <div>
                            <h3 class="text-lg font-semibold mb-4">AI Settings</h3>
                            <div class="card p-6">
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium mb-2">Detection Sensitivity</label>
                                        <input type="range" class="w-full" id="aiSensitivity" min="1" max="10" value="7">
                                        <div class="flex justify-between text-xs text-gray-500 mt-1">
                                            <span>Low</span>
                                            <span>High</span>
                                        </div>
                                    </div>
                                    <div>
                                        <label class="flex items-center space-x-3">
                                            <input type="checkbox" id="faceDetection" checked class="w-5 h-5 text-blue-600">
                                            <span class="text-sm">Face Detection</span>
                                        </label>
                                    </div>
                                    <div>
                                        <label class="flex items-center space-x-3">
                                            <input type="checkbox" id="eyeTracking" checked class="w-5 h-5 text-blue-600">
                                            <span class="text-sm">Eye Tracking</span>
                                        </label>
                                    </div>
                                    <div>
                                        <label class="flex items-center space-x-3">
                                            <input type="checkbox" id="audioDetection" checked class="w-5 h-5 text-blue-600">
                                            <span class="text-sm">Audio Analysis</span>
                                        </label>
                                    </div>
                                    <div>
                                        <label class="flex items-center space-x-3">
                                            <input type="checkbox" id="screenMonitoring" checked class="w-5 h-5 text-blue-600">
                                            <span class="text-sm">Screen Monitoring</span>
                                        </label>
                                    </div>
                                </div>
                                <div class="mt-6">
                                    <button class="btn-primary w-full" onclick="updateAISettings()">
                                        <i class="fas fa-save mr-2"></i>Update Settings
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Admin: System Analytics Section -->
            <div id="system-analytics-section" class="section hidden fade-in">
                <div class="card p-6">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h2 class="text-2xl font-bold">System Analytics</h2>
                            <p class="text-gray-600 dark:text-gray-400">Comprehensive system performance and usage analytics</p>
                        </div>
                        <div class="flex space-x-3">
                            <select id="analyticsPeriod" class="input-field">
                                <option value="7d">Last 7 Days</option>
                                <option value="30d" selected>Last 30 Days</option>
                                <option value="90d">Last 90 Days</option>
                            </select>
                        </div>
                    </div>

                    <!-- Analytics Overview -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div class="card p-6 text-center">
                            <div class="w-16 h-16 bg-blue-100 dark:bg-blue-900 rounded-xl flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-users text-2xl text-blue-600"></i>
                            </div>
                            <h4 class="font-semibold text-lg mb-2" id="totalActiveUsers">1,247</h4>
                            <p class="text-gray-600 dark:text-gray-400 text-sm">Active Users</p>
                        </div>

                        <div class="card p-6 text-center">
                            <div class="w-16 h-16 bg-green-100 dark:bg-green-900 rounded-xl flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-clipboard-check text-2xl text-green-600"></i>
                            </div>
                            <h4 class="font-semibold text-lg mb-2" id="totalExamsCompleted">856</h4>
                            <p class="text-gray-600 dark:text-gray-400 text-sm">Exams Completed</p>
                        </div>

                        <div class="card p-6 text-center">
                            <div class="w-16 h-16 bg-purple-100 dark:bg-purple-900 rounded-xl flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-chart-line text-2xl text-purple-600"></i>
                            </div>
                            <h4 class="font-semibold text-lg mb-2" id="systemUptime">99.8%</h4>
                            <p class="text-gray-600 dark:text-gray-400 text-sm">System Uptime</p>
                        </div>
                    </div>

                    <!-- Detailed Analytics -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div>
                            <h3 class="text-lg font-semibold mb-4">Usage Statistics</h3>
                            <div class="card p-6">
                                <div class="space-y-4">
                                    <div class="flex justify-between items-center">
                                        <span>Peak Concurrent Users</span>
                                        <span class="font-semibold">284</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span>Average Session Duration</span>
                                        <span class="font-semibold">47 min</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span>API Requests (24h)</span>
                                        <span class="font-semibold">12.4K</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span>Data Processed</span>
                                        <span class="font-semibold">4.2 GB</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div>
                            <h3 class="text-lg font-semibold mb-4">Performance Metrics</h3>
                            <div class="card p-6">
                                <div class="space-y-4">
                                    <div class="flex justify-between items-center">
                                        <span>Response Time (Avg)</span>
                                        <span class="font-semibold">128 ms</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span>Error Rate</span>
                                        <span class="font-semibold">0.02%</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span>Server Load</span>
                                        <span class="font-semibold">42%</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span>Database Queries</span>
                                        <span class="font-semibold">8.7K/min</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Admin: Announcements Section -->
            <div id="announcements-section" class="section hidden fade-in">
                <div class="card p-6">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h2 class="text-2xl font-bold">System Announcements</h2>
                            <p class="text-gray-600 dark:text-gray-400">Broadcast announcements to users</p>
                        </div>
                        <div class="flex space-x-3">
                            <button class="btn-primary" onclick="createAnnouncement()">
                                <i class="fas fa-plus mr-2"></i>New Announcement
                            </button>
                        </div>
                    </div>

                    <!-- Create Announcement Form -->
                    <div class="card p-6 mb-6" id="announcementForm" style="display: none;">
                        <h3 class="text-lg font-semibold mb-4">Create Announcement</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-medium mb-2">Title *</label>
                                <input type="text" class="input-field w-full" id="announcementTitle" placeholder="Announcement title">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Priority</label>
                                <select class="input-field w-full" id="announcementPriority">
                                    <option value="low">Low</option>
                                    <option value="medium" selected>Medium</option>
                                    <option value="high">High</option>
                                    <option value="urgent">Urgent</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Target Audience</label>
                                <select class="input-field w-full" id="announcementTarget">
                                    <option value="all">All Users</option>
                                    <option value="students">Students Only</option>
                                    <option value="experts">Experts Only</option>
                                    <option value="administrators">Administrators Only</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Type</label>
                                <select class="input-field w-full" id="announcementType">
                                    <option value="general">General</option>
                                    <option value="maintenance">Maintenance</option>
                                    <option value="feature">New Feature</option>
                                    <option value="security">Security Update</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2">Message *</label>
                            <textarea class="input-field w-full" id="announcementMessage" rows="4" placeholder="Announcement message"></textarea>
                        </div>
                        <div class="flex justify-end space-x-3">
                            <button class="btn-secondary" onclick="cancelAnnouncement()">Cancel</button>
                            <button class="btn-primary" onclick="publishAnnouncement()">
                                <i class="fas fa-bullhorn mr-2"></i>Publish
                            </button>
                        </div>
                    </div>

                    <!-- Announcements List -->
                    <div id="announcementsList">
                        <!-- Announcements will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Notifications Section -->
            <div id="notifications-section" class="section hidden fade-in">
                <div class="card p-6">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h2 class="text-2xl font-bold">Notifications & Alerts</h2>
                            <p class="text-gray-600 dark:text-gray-400">System notifications and user alerts</p>
                        </div>
                        <div class="flex space-x-3">
                            <button class="btn-secondary" onclick="markAllNotificationsRead()">
                                <i class="fas fa-check mr-2"></i>Mark All Read
                            </button>
                        </div>
                    </div>

                    <div id="notificationsFullList">
                        <!-- Notifications will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Issues Section -->
            <div id="issues-section" class="section hidden fade-in">
                <div class="card p-6">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h2 class="text-2xl font-bold">Report Issues</h2>
                            <p class="text-gray-600 dark:text-gray-400">Report technical issues or problems</p>
                        </div>
                    </div>

                    <!-- Issue Report Form -->
                    <div class="card p-6">
                        <h3 class="text-lg font-semibold mb-4">Submit Issue Report</h3>
                        <form id="issueReportForm" class="space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium mb-2">Issue Type *</label>
                                    <select class="input-field w-full" id="issueType" required>
                                        <option value="">Select Type</option>
                                        <option value="technical">Technical Problem</option>
                                        <option value="exam">Exam Related</option>
                                        <option value="authentication">Login/Authentication</option>
                                        <option value="performance">Performance Issue</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">Priority</label>
                                    <select class="input-field w-full" id="issuePriority">
                                        <option value="low">Low</option>
                                        <option value="medium" selected>Medium</option>
                                        <option value="high">High</option>
                                        <option value="critical">Critical</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Subject *</label>
                                <input type="text" class="input-field w-full" id="issueSubject" placeholder="Brief description of the issue" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Description *</label>
                                <textarea class="input-field w-full" id="issueDescription" rows="6" placeholder="Please provide detailed information about the issue, including steps to reproduce it" required></textarea>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Attachments (Optional)</label>
                                <input type="file" class="input-field w-full" id="issueAttachment" accept=".jpg,.jpeg,.png,.pdf,.doc,.docx" multiple>
                                <p class="text-sm text-gray-500 mt-1">Attach screenshots or relevant files (Max 10MB per file)</p>
                            </div>
                            <div class="flex justify-end">
                                <button type="submit" class="btn-primary">
                                    <i class="fas fa-paper-plane mr-2"></i>Submit Issue
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Student: Exam Taking Interface -->
            <div id="exam-taking-section" class="section hidden exam-mode">
                <div class="card p-6">
                    <!-- Exam Header -->
                    <div class="flex justify-between items-center mb-6 border-b pb-4">
                        <div>
                            <h2 class="text-2xl font-bold" id="examTakingTitle">Exam Title</h2>
                            <p class="text-gray-600" id="examTakingInstructions">Exam instructions will appear here</p>
                        </div>
                        <div class="flex items-center space-x-4">
                            <div class="exam-timer" id="examTakingTimer">
                                <i class="fas fa-clock mr-2"></i>
                                <span id="examTimeRemaining">02:00:00</span>
                            </div>
                            <button class="btn-danger" onclick="submitExam()">
                                <i class="fas fa-paper-plane mr-2"></i>Submit
                            </button>
                        </div>
                    </div>

                    <!-- Question Navigation -->
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <span class="text-sm text-gray-600">Question <span id="currentQuestionNumber">1</span> of <span id="totalQuestions">10</span></span>
                        </div>
                        <div class="flex space-x-2" id="questionNavigation">
                            <!-- Question navigation buttons will be populated here -->
                        </div>
                    </div>

                    <!-- Progress Bar -->
                    <div class="progress-indicator mb-6">
                        <div class="progress-fill" id="examProgress" style="width: 10%"></div>
                    </div>

                    <!-- Question Content -->
                    <div id="questionContent" class="question-card active">
                        <!-- Current question will be displayed here -->
                    </div>

                    <!-- Navigation Buttons -->
                    <div class="flex justify-between items-center mt-6">
                        <button class="btn-secondary" id="prevQuestionBtn" onclick="previousQuestion()" disabled>
                            <i class="fas fa-arrow-left mr-2"></i>Previous
                        </button>
                        <div class="flex space-x-3">
                            <button class="btn-secondary" onclick="flagQuestion()">
                                <i class="fas fa-flag mr-2"></i>Flag for Review
                            </button>
                            <button class="btn-primary" id="nextQuestionBtn" onclick="nextQuestion()">
                                Next<i class="fas fa-arrow-right ml-2"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <script>
        // Enhanced global state management
        let currentUser = null;
        let currentExam = null;
        let currentQuestionIndex = 0;
        let examTimer = null;
        let examStartTime = null;
        let studentAnswers = {};
        let flaggedQuestions = new Set();
        let notifications = [];
        let examData = {
            students: [],
            experts: [],
            administrators: [],
            exams: [],
            results: [],
            materials: [],
            practiceTests: [],
            announcements: []
        };

        // Question types configuration
        const questionTypes = {
            'multiple-choice': {
                name: 'Multiple Choice',
                icon: 'fas fa-check-circle',
                description: 'Select one correct answer from multiple options'
            },
            'true-false': {
                name: 'True/False',
                icon: 'fas fa-question-circle',
                description: 'Choose between true or false'
            },
            'short-answer': {
                name: 'Short Answer',
                icon: 'fas fa-pencil-alt',
                description: 'Brief written response (1-2 sentences)'
            },
            'long-answer': {
                name: 'Long Answer',
                icon: 'fas fa-edit',
                description: 'Detailed written response (essay format)'
            },
            'matching': {
                name: 'Matching Items',
                icon: 'fas fa-link',
                description: 'Match items from two columns'
            },
            'practical': {
                name: 'Practical Exercise',
                icon: 'fas fa-code',
                description: 'Hands-on coding or lab exercise'
            }
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 Advanced Exam System initializing...');
            initializeAuth();
            initializeSidebar();
            initializeDarkMode();
            initializeFullscreen();
            loadSampleData();
            updateUI();
            initializeNotifications();
            startRealTimeMonitoring();
        });

        // Authentication and user management
        function initializeAuth() {
            const examSystemAuth = localStorage.getItem('examSystemAuth');
            const examSystemUser = JSON.parse(localStorage.getItem('examSystemUser') || '{}');

            if (!examSystemAuth || !examSystemUser.role) {
                // Default to student role for testing
                currentUser = {
                    id: 'user123',
                    name: 'Test User',
                    email: 'test@example.com',
                    role: 'student',
                    track: 'computing'
                };
            } else {
                currentUser = examSystemUser;
            }

            updateUserInfo();
            showUserNavigation();
            console.log('✅ User authenticated:', currentUser);
        }

        function updateUserInfo() {
            if (!currentUser) return;

            document.getElementById('userName').textContent = currentUser.name || 'User';
            document.getElementById('userRole').textContent = currentUser.role || 'Role';
            document.getElementById('userTrack').textContent = currentUser.track ?
                `${currentUser.track.charAt(0).toUpperCase() + currentUser.track.slice(1)} Track` : '';

            const avatar = document.getElementById('userAvatar');
            const initials = (currentUser.name || 'U').split(' ').map(n => n[0]).join('').toUpperCase();
            avatar.textContent = initials;
        }

        function showUserNavigation() {
            const studentNav = document.getElementById('studentNav');
            const expertNav = document.getElementById('expertNav');
            const adminNav = document.getElementById('adminNav');

            // Hide all navs first
            studentNav.classList.add('hidden');
            expertNav.classList.add('hidden');
            adminNav.classList.add('hidden');

            if (currentUser.role === 'student') {
                studentNav.classList.remove('hidden');
                showSection('available-exams');
            } else if (currentUser.role === 'expert') {
                expertNav.classList.remove('hidden');
                showSection('exam-dashboard');
            } else if (currentUser.role === 'administrator') {
                adminNav.classList.remove('hidden');
                showSection('admin-dashboard');
            }
        }

        // Load comprehensive sample data
        function loadSampleData() {
            examData = {
                tracks: ['computing', 'cloud-computing', 'networking'],
                students: [{
                    id: 'student1',
                    name: 'John Doe',
                    email: 'john@student.com',
                    track: 'computing'
                }, {
                    id: 'student2',
                    name: 'Jane Smith',
                    email: 'jane@student.com',
                    track: 'cloud-computing'
                }, {
                    id: 'student3',
                    name: 'Bob Wilson',
                    email: 'bob@student.com',
                    track: 'networking'
                }],
                experts: [{
                    id: 'expert1',
                    name: 'Dr. Smith',
                    email: 'smith@expert.com',
                    track: 'computing'
                }, {
                    id: 'expert2',
                    name: 'Prof. Johnson',
                    email: 'johnson@expert.com',
                    track: 'networking'
                }],
                administrators: [{
                    id: 'admin1',
                    name: 'Admin User',
                    email: 'admin@system.com'
                }],
                exams: [{
                    id: 'exam1',
                    title: 'Advanced Python Programming Assessment',
                    track: 'computing',
                    duration: 120,
                    totalMarks: 150,
                    startDate: new Date().toISOString(),
                    endDate: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString(),
                    creator: 'expert1',
                    instructions: 'This is an AI-proctored examination for Computing track students. Ensure your camera and microphone are working.',
                    status: 'active',
                    aiProctoring: true,
                    blockchainVerification: true,
                    questions: [{
                        id: 'q1',
                        type: 'multiple-choice',
                        question: 'Which design pattern ensures a class has only one instance?',
                        options: ['Singleton', 'Factory', 'Observer', 'Strategy'],
                        correctAnswer: 0,
                        points: 10
                    }, {
                        id: 'q2',
                        type: 'short-answer',
                        question: 'Explain the difference between a list and a tuple in Python.',
                        points: 15
                    }, {
                        id: 'q3',
                        type: 'true-false',
                        question: 'Python is a statically typed programming language.',
                        correctAnswer: false,
                        points: 5
                    }]
                }, {
                    id: 'exam2',
                    title: 'Network Security Fundamentals',
                    track: 'networking',
                    duration: 90,
                    totalMarks: 100,
                    startDate: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString(),
                    endDate: new Date(Date.now() + 8 * 24 * 60 * 60 * 1000).toISOString(),
                    creator: 'expert2',
                    instructions: 'Network security examination covering protocols and best practices.',
                    status: 'scheduled',
                    aiProctoring: true,
                    blockchainVerification: true,
                    questions: [{
                        id: 'q1',
                        type: 'multiple-choice',
                        question: 'Which protocol is used for secure web communication?',
                        options: ['HTTP', 'HTTPS', 'FTP', 'SMTP'],
                        correctAnswer: 1,
                        points: 10
                    }]
                }],
                results: [{
                    id: 'result1',
                    examId: 'exam1',
                    studentId: 'student1',
                    studentName: 'John Doe',
                    examTitle: 'Advanced Python Programming Assessment',
                    track: 'computing',
                    score: 92,
                    grade: 'A',
                    totalMarks: 150,
                    date: new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString(),
                    securityViolations: 0,
                    status: 'completed',
                    duration: 105
                }],
                materials: [{
                    id: 'mat1',
                    name: 'Python Programming Guide.pdf',
                    type: 'study-guide',
                    track: 'computing',
                    uploadDate: new Date().toISOString(),
                    size: '2.5 MB',
                    uploader: 'expert1',
                    description: 'Comprehensive Python programming reference'
                }],
                practiceTests: [{
                    id: 'practice1',
                    title: 'Python Basics Practice',
                    track: 'computing',
                    questions: 10,
                    duration: 30,
                    difficulty: 'beginner',
                    description: 'Practice test for Python fundamentals'
                }],
                announcements: [{
                    id: 'ann1',
                    title: 'System Maintenance',
                    message: 'The exam system will undergo maintenance on Sunday 2-4 AM',
                    type: 'maintenance',
                    priority: 'medium',
                    targetRole: 'all',
                    date: new Date(),
                    author: 'admin1'
                }]
            };

            // Initialize notifications
            notifications = [{
                id: 'notif1',
                type: 'exam',
                title: 'New Exam Available',
                message: 'Advanced Python Programming Assessment is now available',
                time: new Date(),
                read: false
            }, {
                id: 'notif2',
                type: 'result',
                title: 'Exam Result Published',
                message: 'Your result for Advanced Python Programming is now available',
                time: new Date(Date.now() - 3600000),
                read: false
            }];

            localStorage.setItem('examSystemData', JSON.stringify(examData));
            localStorage.setItem('examNotifications', JSON.stringify(notifications));
            console.log('✅ Sample data loaded');
        }

        // UI Management
        function updateUI() {
            updateNotificationCount();
            updateExamCounts();

            if (currentUser.role === 'student') {
                loadAvailableExams();
                loadStudentResults();
                loadExamHistory();
                loadPracticeTests();
            } else if (currentUser.role === 'expert') {
                loadExpertDashboard();
                loadGradingQueue();
                loadMaterialsList();
            } else if (currentUser.role === 'administrator') {
                loadAdminDashboard();
                loadAIProctoringData();
                loadSystemAnalytics();
            }
        }

        function updateNotificationCount() {
            const unreadCount = notifications.filter(n => !n.read).length;
            document.getElementById('notificationCount').textContent = unreadCount;
            document.getElementById('notificationBadge').textContent = unreadCount;
        }

        function updateExamCounts() {
            const availableExams = examData.exams.filter(e => e.status === 'active').length;
            const pendingGrading = examData.results.filter(r => r.status === 'pending').length;
            const liveExams = examData.exams.filter(e => e.status === 'active').length;

            document.getElementById('availableExamsCount').textContent = availableExams;
            document.getElementById('pendingGradingCount').textContent = pendingGrading;
            document.getElementById('liveExamsCount').textContent = liveExams;
            document.getElementById('activeExamsCount').textContent = availableExams;
        }

        // Section Management
        function showSection(sectionName) {
            console.log('📄 Switching to section:', sectionName);

            document.querySelectorAll('.section').forEach(section => {
                section.classList.add('hidden');
            });

            const targetSection = document.getElementById(`${sectionName}-section`);
            if (targetSection) {
                targetSection.classList.remove('hidden');
                updateHeader(sectionName);
            }

            // Update active nav item
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });

            const activeItem = document.querySelector(`[data-section="${sectionName}"]`);
            if (activeItem) {
                activeItem.classList.add('active');
            }

            // Load section-specific data
            loadSectionData(sectionName);
        }

        function updateHeader(sectionName) {
            const titles = {
                'exam-dashboard': 'Expert Dashboard',
                'admin-dashboard': 'Administrator Console',
                'available-exams': 'Available Examinations',
                'exam-results': 'My Exam Results',
                'exam-history': 'Exam History',
                'practice-tests': 'Practice Tests',
                'create-exam': 'Create Advanced Exam',
                'manage-exams': 'Manage Exams',
                'grade-exams': 'Grade Exams',
                'exam-analytics': 'Exam Analytics',
                'materials-upload': 'Upload Materials',
                'ai-proctoring': 'AI Proctoring Control',
                'live-monitoring': 'Live System Monitoring',
                'system-analytics': 'System Analytics',
                'announcements': 'System Announcements',
                'notifications': 'Notifications & Alerts',
                'issues': 'Report Issues'
            };

            document.getElementById('headerTitle').textContent = titles[sectionName] || 'Advanced Exam System';

            const subtitles = {
                'exam-dashboard': 'Manage exams, grading, and analytics',
                'admin-dashboard': 'System control and monitoring center',
                'available-exams': 'AI-proctored examinations with blockchain verification',
                'exam-results': 'View your examination results and performance analytics',
                'exam-history': 'Complete history of all your examinations',
                'practice-tests': 'Prepare for exams with practice sessions',
                'create-exam': 'Design comprehensive examinations with AI proctoring',
                'manage-exams': 'Edit, monitor, and control your examinations',
                'grade-exams': 'Review and grade student submissions',
                'exam-analytics': 'Detailed performance analytics and insights',
                'materials-upload': 'Share study materials and resources with students',
                'ai-proctoring': 'Monitor and control AI proctoring systems',
                'live-monitoring': 'Real-time monitoring of all system activities',
                'system-analytics': 'Comprehensive system performance and usage analytics',
                'announcements': 'Broadcast announcements to users',
                'notifications': 'System notifications and user alerts',
                'issues': 'Report technical issues or problems'
            };

            document.getElementById('headerSubtitle').textContent = subtitles[sectionName] || 'AI-Powered examination platform';
        }

        function loadSectionData(sectionName) {
            switch (sectionName) {
                case 'available-exams':
                    loadAvailableExams();
                    break;
                case 'exam-results':
                    loadStudentResults();
                    break;
                case 'exam-history':
                    loadExamHistory();
                    break;
                case 'practice-tests':
                    loadPracticeTests();
                    break;
                case 'exam-dashboard':
                    loadExpertDashboard();
                    break;
                case 'manage-exams':
                    loadManageExams();
                    break;
                case 'grade-exams':
                    loadGradingQueue();
                    break;
                case 'exam-analytics':
                    loadExamAnalytics();
                    break;
                case 'materials-upload':
                    loadMaterialsList();
                    break;
                case 'admin-dashboard':
                    loadAdminDashboard();
                    break;
                case 'live-monitoring':
                    loadActiveSessions();
                    break;
                case 'ai-proctoring':
                    loadAIProctoringData();
                    break;
                case 'system-analytics':
                    loadSystemAnalytics();
                    break;
                case 'announcements':
                    loadAnnouncements();
                    break;
                case 'notifications':
                    loadNotificationsList();
                    break;
            }
        }

        // Student Functions
        function loadAvailableExams() {
            const container = document.getElementById('availableExamsList');
            if (!container) return;

            container.innerHTML = '';

            const availableExams = examData.exams.filter(exam => {
                if (currentUser.role !== 'student') return true;
                return exam.status === 'active' &&
                    (exam.track === currentUser.track || exam.track === 'all');
            });

            if (availableExams.length === 0) {
                container.innerHTML = `
                    <div class="col-span-2 text-center py-12">
                        <i class="fas fa-clipboard-list text-6xl text-gray-400 mb-4"></i>
                        <h3 class="text-xl font-semibold text-gray-600 mb-2">No Exams Available</h3>
                        <p class="text-gray-500">Check back later for new examinations</p>
                    </div>
                `;
                return;
            }

            availableExams.forEach(exam => {
                const examCard = document.createElement('div');
                examCard.className = 'card p-6 hover:shadow-lg transition-all';
                examCard.innerHTML = `
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h3 class="text-xl font-bold mb-2">${exam.title}</h3>
                            <div class="flex items-center space-x-2 mb-2">
                                <span class="track-badge track-${exam.track}">${exam.track.replace('-', ' ')}</span>
                                <span class="px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">Available</span>
                            </div>
                            <div class="flex items-center space-x-4 text-sm text-gray-500">
                                <span><i class="fas fa-clock mr-1"></i>${exam.duration} minutes</span>
                                <span><i class="fas fa-trophy mr-1"></i>${exam.totalMarks} marks</span>
                                <span><i class="fas fa-robot mr-1"></i>AI Proctored</span>
                            </div>
                        </div>
                    </div>

                    <div class="text-sm text-gray-600 dark:text-gray-400 mb-4">
                        <p><strong>Available Until:</strong> ${new Date(exam.endDate).toLocaleDateString()}</p>
                        <p><strong>Questions:</strong> ${exam.questions.length}</p>
                    </div>

                    <div class="mb-4">
                        <div class="flex items-center space-x-4 text-sm">
                            <div class="flex items-center text-green-600"><i class="fas fa-robot mr-1"></i>AI Monitoring</div>
                            <div class="flex items-center text-purple-600"><i class="fas fa-link mr-1"></i>Blockchain Secured</div>
                            <div class="flex items-center text-blue-600"><i class="fas fa-shield-alt mr-1"></i>Secure Environment</div>
                        </div>
                    </div>

                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">${exam.instructions}</p>

                    <div class="flex justify-between items-center">
                        <div class="text-sm">
                            <span class="text-gray-500">${exam.questions.length} questions</span>
                        </div>
                        <div class="flex space-x-2">
                            <button class="btn-secondary text-sm px-4 py-2" onclick="previewExamForStudent('${exam.id}')">
                                <i class="fas fa-eye mr-2"></i>Preview
                            </button>
                            <button class="btn-primary" onclick="startExam('${exam.id}')">
                                <i class="fas fa-play mr-2"></i>Start Exam
                            </button>
                        </div>
                    </div>
                `;
                container.appendChild(examCard);
            });
        }

        function loadStudentResults() {
            const container = document.getElementById('examResultsList');
            if (!container) return;

            container.innerHTML = '';

            const studentResults = examData.results.filter(r => r.studentId === currentUser.id);

            // Update summary stats
            if (studentResults.length > 0) {
                const totalExams = studentResults.length;
                const avgScore = Math.round(studentResults.reduce((sum, r) => sum + r.score, 0) / totalExams);
                const highestScore = Math.max(...studentResults.map(r => r.score));
                const passRate = Math.round((studentResults.filter(r => r.score >= 60).length / totalExams) * 100);

                document.getElementById('totalExamsTaken').textContent = totalExams;
                document.getElementById('averageScore').textContent = avgScore + '%';
                document.getElementById('highestScore').textContent = highestScore + '%';
                document.getElementById('passRate').textContent = passRate + '%';
            }

            if (studentResults.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12">
                        <i class="fas fa-chart-bar text-6xl text-gray-400 mb-4"></i>
                        <h3 class="text-xl font-semibold text-gray-600 mb-2">No Results Yet</h3>
                        <p class="text-gray-500">Complete some exams to see your results here</p>
                    </div>
                `;
                return;
            }

            studentResults.forEach(result => {
                const resultCard = document.createElement('div');
                resultCard.className = 'card p-6 mb-4';
                resultCard.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h3 class="text-lg font-semibold mb-2">${result.examTitle}</h3>
                            <div class="flex items-center space-x-4 text-sm text-gray-500 mb-3">
                                <span><i class="fas fa-calendar mr-1"></i>${new Date(result.date).toLocaleDateString()}</span>
                                <span><i class="fas fa-clock mr-1"></i>${result.duration} minutes</span>
                                <span class="track-badge track-${result.track}">${result.track}</span>
                            </div>
                            <div class="grid grid-cols-3 gap-4 text-sm">
                                <div>
                                    <span class="text-gray-500">Score:</span>
                                    <span class="font-semibold text-lg ml-2">${result.score}%</span>
                                </div>
                                <div>
                                    <span class="text-gray-500">Grade:</span>
                                    <span class="font-semibold text-lg ml-2">${result.grade}</span>
                                </div>
                                <div>
                                    <span class="text-gray-500">Status:</span>
                                    <span class="font-semibold text-lg ml-2 ${result.score >= 60 ? 'text-green-600' : 'text-red-600'}">
                                        ${result.score >= 60 ? 'Passed' : 'Failed'}
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="flex flex-col items-end space-y-2">
                            <div class="text-3xl font-bold ${result.score >= 90 ? 'text-green-600' : result.score >= 70 ? 'text-blue-600' : result.score >= 60 ? 'text-yellow-600' : 'text-red-600'}">
                                ${result.score}%
                            </div>
                            <button class="btn-secondary text-sm px-4 py-2" onclick="viewDetailedResult('${result.id}')">
                                <i class="fas fa-chart-line mr-2"></i>Details
                            </button>
                        </div>
                    </div>
                `;
                container.appendChild(resultCard);
            });
        }

        function loadExamHistory() {
            const container = document.getElementById('examHistoryList');
            if (!container) return;

            container.innerHTML = '';

            const allResults = examData.results.filter(r => r.studentId === currentUser.id);

            if (allResults.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12">
                        <i class="fas fa-history text-6xl text-gray-400 mb-4"></i>
                        <h3 class="text-xl font-semibold text-gray-600 mb-2">No History Available</h3>
                        <p class="text-gray-500">Your exam history will appear here</p>
                    </div>
                `;
                return;
            }

            allResults.sort((a, b) => new Date(b.date) - new Date(a.date));

            allResults.forEach(result => {
                const historyCard = document.createElement('div');
                historyCard.className = 'card p-4 mb-4';
                historyCard.innerHTML = `
                    <div class="flex justify-between items-center">
                        <div>
                            <h4 class="font-semibold">${result.examTitle}</h4>
                            <div class="flex items-center space-x-4 text-sm text-gray-500 mt-1">
                                <span>${new Date(result.date).toLocaleString()}</span>
                                <span class="track-badge track-${result.track}">${result.track}</span>
                                <span class="${result.score >= 60 ? 'text-green-600' : 'text-red-600'}">${result.score}% - ${result.grade}</span>
                            </div>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="btn-secondary text-sm px-3 py-1" onclick="viewDetailedResult('${result.id}')">
                                View
                            </button>
                        </div>
                    </div>
                `;
                container.appendChild(historyCard);
            });
        }

        function loadPracticeTests() {
            const container = document.getElementById('practiceTestsList');
            if (!container) return;

            container.innerHTML = '';

            const practiceTests = examData.practiceTests.filter(test =>
                test.track === currentUser.track || test.track === 'all'
            );

            if (practiceTests.length === 0) {
                container.innerHTML = `
                    <div class="col-span-3 text-center py-12">
                        <i class="fas fa-dumbbell text-6xl text-gray-400 mb-4"></i>
                        <h3 class="text-xl font-semibold text-gray-600 mb-2">No Practice Tests</h3>
                        <p class="text-gray-500">Practice tests will be available soon</p>
                    </div>
                `;
                return;
            }

            practiceTests.forEach(test => {
                const testCard = document.createElement('div');
                testCard.className = 'card p-6';
                testCard.innerHTML = `
                    <div class="text-center">
                        <div class="w-16 h-16 bg-blue-100 dark:bg-blue-900 rounded-xl flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-dumbbell text-2xl text-blue-600"></i>
                        </div>
                        <h3 class="text-lg font-semibold mb-2">${test.title}</h3>
                        <p class="text-sm text-gray-600 mb-4">${test.description}</p>
                        <div class="flex justify-center space-x-4 text-sm text-gray-500 mb-4">
                            <span><i class="fas fa-question mr-1"></i>${test.questions} questions</span>
                            <span><i class="fas fa-clock mr-1"></i>${test.duration} min</span>
                        </div>
                        <div class="mb-4">
                            <span class="px-3 py-1 rounded-full text-xs font-medium ${
                                test.difficulty === 'beginner' ? 'bg-green-100 text-green-800' :
                                test.difficulty === 'intermediate' ? 'bg-yellow-100 text-yellow-800' :
                                'bg-red-100 text-red-800'
                            }">${test.difficulty}</span>
                        </div>
                        <button class="btn-primary w-full" onclick="startPracticeTest('${test.id}')">
                            <i class="fas fa-play mr-2"></i>Start Practice
                        </button>
                    </div>
                `;
                container.appendChild(testCard);
            });
        }

        // Expert Functions
        function loadExpertDashboard() {
            const expertExams = examData.exams.filter(e => e.creator === currentUser.id);
            const activeExams = expertExams.filter(e => e.status === 'active').length;
            const pendingGrading = examData.results.filter(r => r.status === 'pending').length;
            const totalStudents = examData.students.length;

            const expertResults = examData.results.filter(r => {
                const exam = examData.exams.find(e => e.id === r.examId);
                return exam && exam.creator === currentUser.id;
            });
            const avgScore = expertResults.length > 0 ?
                Math.round(expertResults.reduce((sum, r) => sum + r.score, 0) / expertResults.length) : 0;

            document.getElementById('expertActiveExams').textContent = activeExams;
            document.getElementById('expertPendingGrading').textContent = pendingGrading;
            document.getElementById('expertAvgScore').textContent = avgScore + '%';
            document.getElementById('expertTotalStudents').textContent = totalStudents;

            loadExpertRecentExams();
        }

        function loadExpertRecentExams() {
            const container = document.getElementById('expertRecentExams');
            if (!container) return;

            container.innerHTML = '';

            const recentExams = examData.exams
                .filter(e => e.creator === currentUser.id)
                .slice(0, 5);

            if (recentExams.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8 text-gray-500">
                        <i class="fas fa-clipboard-list text-4xl mb-4"></i>
                        <p>No exams created yet</p>
                        <button class="btn-primary mt-4" onclick="showSection('create-exam')">
                            <i class="fas fa-plus mr-2"></i>Create Your First Exam
                        </button>
                    </div>
                `;
                return;
            }

            recentExams.forEach(exam => {
                const examCard = document.createElement('div');
                examCard.className = 'card p-4';
                examCard.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div>
                            <h4 class="font-semibold">${exam.title}</h4>
                            <p class="text-sm text-gray-500">${exam.track} • ${exam.questions.length} questions</p>
                            <div class="flex items-center space-x-2 mt-2">
                                <span class="px-2 py-1 bg-${exam.status === 'active' ? 'green' : 'yellow'}-100 text-${exam.status === 'active' ? 'green' : 'yellow'}-800 rounded-full text-xs font-medium">
                                    ${exam.status}
                                </span>
                                ${exam.aiProctoring ? '<i class="fas fa-robot text-purple-600 text-sm" title="AI Proctored"></i>' : ''}
                                ${exam.blockchainVerification ? '<i class="fas fa-link text-blue-600 text-sm" title="Blockchain Verified"></i>' : ''}
                            </div>
                        </div>
                    </div>
                    <div class="mt-3 flex justify-between items-center">
                        <span class="text-sm text-gray-600">${exam.totalMarks} marks • ${exam.duration} min</span>
                        <div class="flex space-x-2">
                            <button class="btn-secondary text-xs px-3 py-1" onclick="editExam('${exam.id}')">Edit</button>
                            <button class="btn-secondary text-xs px-3 py-1" onclick="viewExamAnalytics('${exam.id}')">Analytics</button>
                        </div>
                    </div>
                `;
                container.appendChild(examCard);
            });
        }

        function loadManageExams() {
            const container = document.getElementById('manageExamsList');
            if (!container) return;

            container.innerHTML = '';

            const expertExams = examData.exams.filter(e => e.creator === currentUser.id);

            if (expertExams.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12">
                        <i class="fas fa-clipboard-list text-6xl text-gray-400 mb-4"></i>
                        <h3 class="text-xl font-semibold text-gray-600 mb-2">No Exams Created</h3>
                        <p class="text-gray-500 mb-4">Create your first exam to get started</p>
                        <button class="btn-primary" onclick="showSection('create-exam')">
                            <i class="fas fa-plus mr-2"></i>Create Exam
                        </button>
                    </div>
                `;
                return;
            }

            expertExams.forEach(exam => {
                        const examCard = document.createElement('div');
                        examCard.className = 'card p-6 mb-4';
                        examCard.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h3 class="text-xl font-semibold mb-2">${exam.title}</h3>
                            <div class="flex items-center space-x-4 text-sm text-gray-500 mb-3">
                                <span class="track-badge track-${exam.track}">${exam.track.replace('-', ' ')}</span>
                                <span class="px-3 py-1 bg-${exam.status === 'active' ? 'green' : exam.status === 'draft' ? 'yellow' : 'gray'}-100 text-${exam.status === 'active' ? 'green' : exam.status === 'draft' ? 'yellow' : 'gray'}-800 rounded-full text-xs font-medium">
                                    ${exam.status}
                                </span>
                                <span><i class="fas fa-clock mr-1"></i>${exam.duration} min</span>
                                <span><i class="fas fa-trophy mr-1"></i>${exam.totalMarks} marks</span>
                            </div>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                                <div>
                                    <span class="text-gray-500">Questions:</span>
                                    <span class="font-semibold ml-2">${exam.questions.length}</span>
                                </div>
                                <div>
                                    <span class="text-gray-500">Students:</span>
                                    <span class="font-semibold ml-2">${getExamStudentCount(exam.id)}</span>
                                </div>
                                <div>
                                    <span class="text-gray-500">Created:</span>
                                    <span class="font-semibold ml-2">${new Date(exam.startDate).toLocaleDateString()}</span>
                                </div>
                                <div>
                                    <span class="text-gray-500">Avg Score:</span>
                                    <span class="font-semibold ml-2">${getExamAverageScore(exam.id)}%</span>
                                </div>
                            </div>
                        </div>
                        <div class="flex flex-col space-y-2 ml-4">
                            <button class="btn-primary text-sm px-4 py-2" onclick="editExam('${exam.id}')">
                                <i class="fas fa-edit mr-2"></i>Edit
                            </button>
                            <button class="btn-secondary text-sm px-4 py-2" onclick="viewExamAnalytics('${exam.id}')">
                                <i class="fas fa-chart-line mr-2"></i>Analytics
                            </button>
                            <button class="btn-secondary text-sm px-4 py-2" onclick="duplicateExam('${exam.id}')">
                                <i class="fas fa-copy mr-2"></i>Duplicate
                            </button>
                            ${exam.status === 'active' ? 
                                `<button class="btn-danger text-sm px-4 py-2" onclick="deactivateExam('${exam.id}')">
                                    <i class="fas fa-stop mr-2"></i>Deactivate
                                </button>` :
                                `<button class="btn-success text-sm px-4 py-2" onclick="activateExam('${exam.id}')">
                                    <i class="fas fa-play mr-2"></i>Activate
                                </button>`
                            }
                        </div>
                    </div>
                `;
                container.appendChild(examCard);
            });
        }

        function loadGradingQueue() {
            const container = document.getElementById('gradingList');
            if (!container) return;

            container.innerHTML = '';

            // Get submissions for expert's exams
            const expertExams = examData.exams.filter(e => e.creator === currentUser.id);
            const submissions = examData.results.filter(r => {
                const exam = expertExams.find(e => e.id === r.examId);
                return exam && (r.status === 'pending' || r.status === 'completed');
            });

            if (submissions.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12">
                        <i class="fas fa-marker text-6xl text-gray-400 mb-4"></i>
                        <h3 class="text-xl font-semibold text-gray-600 mb-2">No Submissions</h3>
                        <p class="text-gray-500">Student submissions will appear here</p>
                    </div>
                `;
                return;
            }

            submissions.forEach(submission => {
                const submissionCard = document.createElement('div');
                submissionCard.className = 'card p-6 mb-4';
                submissionCard.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h3 class="text-lg font-semibold mb-2">${submission.examTitle}</h3>
                            <div class="flex items-center space-x-4 text-sm text-gray-500 mb-3">
                                <span><i class="fas fa-user mr-1"></i>${submission.studentName}</span>
                                <span><i class="fas fa-calendar mr-1"></i>${new Date(submission.date).toLocaleDateString()}</span>
                                <span class="px-3 py-1 bg-${submission.status === 'pending' ? 'yellow' : 'green'}-100 text-${submission.status === 'pending' ? 'yellow' : 'green'}-800 rounded-full text-xs font-medium">
                                    ${submission.status}
                                </span>
                            </div>
                            <div class="grid grid-cols-3 gap-4 text-sm">
                                <div>
                                    <span class="text-gray-500">Score:</span>
                                    <span class="font-semibold ml-2">${submission.status === 'pending' ? 'Pending' : submission.score + '%'}</span>
                                </div>
                                <div>
                                    <span class="text-gray-500">Duration:</span>
                                    <span class="font-semibold ml-2">${submission.duration || 'N/A'} min</span>
                                </div>
                                <div>
                                    <span class="text-gray-500">Violations:</span>
                                    <span class="font-semibold ml-2 ${submission.securityViolations > 0 ? 'text-red-600' : 'text-green-600'}">
                                        ${submission.securityViolations}
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="flex flex-col space-y-2 ml-4">
                            <button class="btn-primary text-sm px-4 py-2" onclick="gradeSubmission('${submission.id}')">
                                <i class="fas fa-marker mr-2"></i>${submission.status === 'pending' ? 'Grade' : 'Review'}
                            </button>
                            <button class="btn-secondary text-sm px-4 py-2" onclick="viewSubmissionDetails('${submission.id}')">
                                <i class="fas fa-eye mr-2"></i>Details
                            </button>
                        </div>
                    </div>
                `;
                container.appendChild(submissionCard);
            });
        }

        function loadExamAnalytics() {
            const select = document.getElementById('analyticsExamSelect');
            const container = document.getElementById('analyticsContent');
            
            if (!select || !container) return;

            // Populate exam selector
            select.innerHTML = '<option value="">Select Exam</option>';
            const expertExams = examData.exams.filter(e => e.creator === currentUser.id);
            expertExams.forEach(exam => {
                const option = document.createElement('option');
                option.value = exam.id;
                option.textContent = exam.title;
                select.appendChild(option);
            });

            // Show default analytics
            container.innerHTML = `
                <div class="text-center py-12">
                    <i class="fas fa-chart-line text-6xl text-gray-400 mb-4"></i>
                    <h3 class="text-xl font-semibold text-gray-600 mb-2">Select an Exam</h3>
                    <p class="text-gray-500">Choose an exam from the dropdown to view detailed analytics</p>
                </div>
            `;

            // Add event listener for exam selection
            select.addEventListener('change', function() {
                if (this.value) {
                    displayExamAnalytics(this.value);
                }
            });
        }

        function loadMaterialsList() {
            const container = document.getElementById('uploadedMaterialsList');
            if (!container) return;

            container.innerHTML = '';

            const expertMaterials = examData.materials.filter(m => m.uploader === currentUser.id);

            if (expertMaterials.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8">
                        <i class="fas fa-upload text-4xl text-gray-400 mb-4"></i>
                        <h3 class="text-lg font-semibold text-gray-600 mb-2">No Materials Uploaded</h3>
                        <p class="text-gray-500">Upload your first study material above</p>
                    </div>
                `;
                return;
            }

            expertMaterials.forEach(material => {
                const materialCard = document.createElement('div');
                materialCard.className = 'card p-4 mb-4';
                materialCard.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex items-center">
                            <div class="w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center mr-4">
                                <i class="fas fa-file-pdf text-xl text-blue-600"></i>
                            </div>
                            <div>
                                <h4 class="font-semibold">${material.name}</h4>
                                <div class="flex items-center space-x-4 text-sm text-gray-500">
                                    <span class="track-badge track-${material.track}">${material.track}</span>
                                    <span>${material.size}</span>
                                    <span>${new Date(material.uploadDate).toLocaleDateString()}</span>
                                </div>
                                <p class="text-sm text-gray-600 mt-1">${material.description}</p>
                            </div>
                        </div>
                        <div class="flex space-x-2">
                            <button class="btn-secondary text-sm px-3 py-1" onclick="downloadMaterial('${material.id}')">
                                <i class="fas fa-download mr-1"></i>Download
                            </button>
                            <button class="btn-danger text-sm px-3 py-1" onclick="deleteMaterial('${material.id}')">
                                <i class="fas fa-trash mr-1"></i>Delete
                            </button>
                        </div>
                    </div>
                `;
                container.appendChild(materialCard);
            });
        }

        // Admin Functions
        function loadAdminDashboard() {
            const activeSessions = 12; // Simulated data
            const securityAlerts = 3; // Simulated data
            const totalUsers = examData.students.length + examData.experts.length + examData.administrators.length;

            document.getElementById('adminActiveSessions').textContent = activeSessions;
            document.getElementById('adminSecurityAlerts').textContent = securityAlerts;
            document.getElementById('adminSystemHealth').textContent = '99.8%';
            document.getElementById('adminTotalUsers').textContent = totalUsers;
        }

        function loadActiveSessions() {
            const container = document.getElementById('activeSessionsList');
            if (!container) return;

            container.innerHTML = '';

            // Simulated active sessions
            const activeSessions = [
                { student: 'John Doe', exam: 'Python Assessment', startTime: '10:30 AM', duration: '45 min', status: 'Active' },
                { student: 'Jane Smith', exam: 'Cloud Computing', startTime: '10:15 AM', duration: '60 min', status: 'Active' },
                { student: 'Bob Wilson', exam: 'Network Security', startTime: '9:45 AM', duration: '90 min', status: 'Active' }
            ];

            activeSessions.forEach(session => {
                const sessionCard = document.createElement('div');
                sessionCard.className = 'card p-4 mb-3';
                sessionCard.innerHTML = `
                    <div class="flex justify-between items-center">
                        <div>
                            <h4 class="font-semibold">${session.student}</h4>
                            <p class="text-sm text-gray-500">${session.exam}</p>
                            <div class="flex items-center space-x-4 text-sm text-gray-600 mt-1">
                                <span>Started: ${session.startTime}</span>
                                <span>Duration: ${session.duration}</span>
                            </div>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium">${session.status}</span>
                            <button class="btn-secondary text-sm px-3 py-1" onclick="monitorSession('${session.student}')">
                                <i class="fas fa-eye mr-1"></i>Monitor
                            </button>
                        </div>
                    </div>
                `;
                container.appendChild(sessionCard);
            });
        }

        function loadAIProctoringData() {
            // Simulated AI detection data
            const detections = [
                { time: '10:35 AM', student: 'John Doe', type: 'Face not visible', severity: 'medium' },
                { time: '10:28 AM', student: 'Jane Smith', type: 'Multiple faces detected', severity: 'high' },
                { time: '10:15 AM', student: 'Bob Wilson', type: 'Looking away frequently', severity: 'low' }
            ];

            const container = document.getElementById('aiDetectionsList');
            if (!container) return;

            container.innerHTML = '';

            detections.forEach(detection => {
                const detectionCard = document.createElement('div');
                detectionCard.className = 'card p-4 mb-3';
                detectionCard.innerHTML = `
                    <div class="flex justify-between items-center">
                        <div>
                            <h4 class="font-semibold">${detection.student}</h4>
                            <p class="text-sm text-gray-600">${detection.type}</p>
                            <p class="text-xs text-gray-500">${detection.time}</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="px-2 py-1 bg-${detection.severity === 'high' ? 'red' : detection.severity === 'medium' ? 'yellow' : 'blue'}-100 text-${detection.severity === 'high' ? 'red' : detection.severity === 'medium' ? 'yellow' : 'blue'}-800 rounded-full text-xs">
                                ${detection.severity}
                            </span>
                            <button class="btn-secondary text-sm px-3 py-1" onclick="investigateDetection('${detection.student}')">
                                Investigate
                            </button>
                        </div>
                    </div>
                `;
                container.appendChild(detectionCard);
            });
        }

        function loadSystemAnalytics() {
            // Update analytics data with simulated values
            document.getElementById('totalActiveUsers').textContent = '1,247';
            document.getElementById('totalExamsCompleted').textContent = '856';
            document.getElementById('systemUptime').textContent = '99.8%';
        }

        function loadAnnouncements() {
            const container = document.getElementById('announcementsList');
            if (!container) return;

            container.innerHTML = '';

            if (examData.announcements.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8">
                        <i class="fas fa-bullhorn text-4xl text-gray-400 mb-4"></i>
                        <h3 class="text-lg font-semibold text-gray-600 mb-2">No Announcements</h3>
                        <p class="text-gray-500">Create your first announcement above</p>
                    </div>
                `;
                return;
            }

            examData.announcements.forEach(announcement => {
                const announcementCard = document.createElement('div');
                announcementCard.className = 'card p-6 mb-4';
                announcementCard.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h3 class="text-lg font-semibold mb-2">${announcement.title}</h3>
                            <div class="flex items-center space-x-4 text-sm text-gray-500 mb-3">
                                <span class="px-3 py-1 bg-${announcement.priority === 'urgent' ? 'red' : announcement.priority === 'high' ? 'orange' : announcement.priority === 'medium' ? 'yellow' : 'blue'}-100 text-${announcement.priority === 'urgent' ? 'red' : announcement.priority === 'high' ? 'orange' : announcement.priority === 'medium' ? 'yellow' : 'blue'}-800 rounded-full text-xs font-medium">
                                    ${announcement.priority}
                                </span>
                                <span class="px-3 py-1 bg-gray-100 text-gray-800 rounded-full text-xs font-medium">
                                    ${announcement.targetRole}
                                </span>
                                <span>${new Date(announcement.date).toLocaleDateString()}</span>
                            </div>
                            <p class="text-gray-600">${announcement.message}</p>
                        </div>
                        <div class="flex space-x-2 ml-4">
                            <button class="btn-secondary text-sm px-3 py-1" onclick="editAnnouncement('${announcement.id}')">
                                Edit
                            </button>
                            <button class="btn-danger text-sm px-3 py-1" onclick="deleteAnnouncement('${announcement.id}')">
                                Delete
                            </button>
                        </div>
                    </div>
                `;
                container.appendChild(announcementCard);
            });
        }

        function loadNotificationsList() {
            const container = document.getElementById('notificationsFullList');
            if (!container) return;

            container.innerHTML = '';

            if (notifications.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8">
                        <i class="fas fa-bell text-4xl text-gray-400 mb-4"></i>
                        <h3 class="text-lg font-semibold text-gray-600 mb-2">No Notifications</h3>
                        <p class="text-gray-500">You're all caught up!</p>
                    </div>
                `;
                return;
            }

            notifications.forEach(notification => {
                const notificationCard = document.createElement('div');
                notificationCard.className = `card p-4 mb-3 ${!notification.read ? 'border-l-4 border-blue-500' : ''}`;
                notificationCard.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h4 class="font-semibold ${!notification.read ? 'text-blue-600' : ''}">${notification.title}</h4>
                            <p class="text-sm text-gray-600 mt-1">${notification.message}</p>
                            <p class="text-xs text-gray-500 mt-2">${new Date(notification.time).toLocaleString()}</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            ${!notification.read ? '<div class="w-2 h-2 bg-blue-500 rounded-full"></div>' : ''}
                            <button class="btn-secondary text-sm px-3 py-1" onclick="markNotificationRead('${notification.id}')">
                                ${notification.read ? 'Read' : 'Mark Read'}
                            </button>
                        </div>
                    </div>
                `;
                container.appendChild(notificationCard);
            });
        }

        // Utility Functions
        function getExamStudentCount(examId) {
            return examData.results.filter(r => r.examId === examId).length;
        }

        function getExamAverageScore(examId) {
            const results = examData.results.filter(r => r.examId === examId);
            if (results.length === 0) return 0;
            return Math.round(results.reduce((sum, r) => sum + r.score, 0) / results.length);
        }

        // Exam Functions
        function startExam(examId) {
            const exam = examData.exams.find(e => e.id === examId);
            if (!exam) return;

            showModal('Start Examination', `
                <div class="text-center">
                    <h3 class="text-xl font-semibold mb-4">${exam.title}</h3>
                    <div class="bg-yellow-50 dark:bg-yellow-900 p-4 rounded-lg mb-4">
                        <h4 class="font-semibold text-yellow-800 dark:text-yellow-200 mb-2">Important Instructions:</h4>
                        <ul class="text-sm text-yellow-700 dark:text-yellow-300 text-left space-y-1">
                            <li>• Ensure your camera and microphone are working</li>
                            <li>• You will be monitored by AI throughout the exam</li>
                            <li>• Do not leave the exam window or tab</li>
                            <li>• Any suspicious activity will be flagged</li>
                            <li>• You have ${exam.duration} minutes to complete</li>
                        </ul>
                    </div>
                    <p class="text-gray-600 mb-4">Once you start, the timer will begin and cannot be paused.</p>
                </div>
            `, [
                { text: 'Cancel', action: () => {}, class: 'btn-secondary' },
                { text: 'Start Exam', action: () => { beginExam(examId); }, class: 'btn-primary' }
            ]);
        }

        function beginExam(examId) {
            const exam = examData.exams.find(e => e.id === examId);
            if (!exam) return;

            currentExam = exam;
            currentQuestionIndex = 0;
            studentAnswers = {};
            flaggedQuestions = new Set();
            examStartTime = Date.now();

            // Start timer
            startExamTimer(exam.duration * 60); // Convert minutes to seconds

            // Show exam interface
            showSection('exam-taking');
            setupExamInterface();
            showCurrentQuestion();

            showToast('Exam started successfully', 'success');
        }

        function startExamTimer(seconds) {
            const timerElement = document.getElementById('examTimeRemaining');
            const headerTimer = document.getElementById('examTimer');
            
            headerTimer.classList.remove('hidden');
            
            examTimer = setInterval(() => {
                const hours = Math.floor(seconds / 3600);
                const minutes = Math.floor((seconds % 3600) / 60);
                const secs = seconds % 60;
                
                const timeString = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
                
                timerElement.textContent = timeString;
                document.getElementById('timeRemaining').textContent = timeString;
                
                // Change timer color based on remaining time
                if (seconds <= 300) { // 5 minutes
                    headerTimer.classList.add('critical');
                } else if (seconds <= 900) { // 15 minutes
                    headerTimer.classList.add('warning');
                }
                
                if (seconds <= 0) {
                    clearInterval(examTimer);
                    autoSubmitExam();
                    return;
                }
                
                seconds--;
            }, 1000);
        }

        function setupExamInterface() {
            if (!currentExam) return;

            document.getElementById('examTakingTitle').textContent = currentExam.title;
            document.getElementById('examTakingInstructions').textContent = currentExam.instructions;
            document.getElementById('totalQuestions').textContent = currentExam.questions.length;

            // Setup question navigation
            const navContainer = document.getElementById('questionNavigation');
            navContainer.innerHTML = '';

            currentExam.questions.forEach((_, index) => {
                const navBtn = document.createElement('button');
                navBtn.className = 'w-8 h-8 rounded-full border border-gray-300 text-sm font-medium hover:bg-gray-100';
                navBtn.textContent = index + 1;
                navBtn.onclick = () => goToQuestion(index);
                navContainer.appendChild(navBtn);
            });
        }

        function showCurrentQuestion() {
            if (!currentExam || currentQuestionIndex >= currentExam.questions.length) return;

            const question = currentExam.questions[currentQuestionIndex];
            const container = document.getElementById('questionContent');
            
            document.getElementById('currentQuestionNumber').textContent = currentQuestionIndex + 1;
            
            // Update progress
            const progress = ((currentQuestionIndex + 1) / currentExam.questions.length) * 100;
            document.getElementById('examProgress').style.width = progress + '%';

            let questionHTML = '';

            switch(question.type) {
                case 'multiple-choice':
                    questionHTML = `
                        <h3 class="text-lg font-semibold mb-4">${question.question}</h3>
                        <div class="space-y-3">
                            ${question.options.map((option, index) => `
                                <label class="flex items-center p-3 border rounded-lg hover:bg-gray-50 cursor-pointer">
                                    <input type="radio" name="answer" value="${index}" class="mr-3" ${studentAnswers[question.id] == index ? 'checked' : ''}>
                                    <span>${option}</span>
                                </label>
                            `).join('')}
                        </div>
                    `;
                    break;

                case 'true-false':
                    questionHTML = `
                        <h3 class="text-lg font-semibold mb-4">${question.question}</h3>
                        <div class="space-y-3">
                            <label class="flex items-center p-3 border rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="radio" name="answer" value="true" class="mr-3" ${studentAnswers[question.id] === true ? 'checked' : ''}>
                                <span>True</span>
                            </label>
                            <label class="flex items-center p-3 border rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="radio" name="answer" value="false" class="mr-3" ${studentAnswers[question.id] === false ? 'checked' : ''}>
                                <span>False</span>
                            </label>
                        </div>
                    `;
                    break;

                case 'short-answer':
                case 'long-answer':
                    const rows = question.type === 'long-answer' ? 8 : 3;
                    questionHTML = `
                        <h3 class="text-lg font-semibold mb-4">${question.question}</h3>
                        <textarea 
                            class="input-field w-full" 
                            rows="${rows}" 
                            placeholder="Enter your answer here..."
                            name="answer"
                        >${studentAnswers[question.id] || ''}</textarea>
                    `;
                    break;

                default:
                    questionHTML = `
                        <h3 class="text-lg font-semibold mb-4">${question.question}</h3>
                        <p class="text-gray-500">Question type not implemented yet.</p>
                    `;
            }

            container.innerHTML = questionHTML;

            // Add event listeners for saving answers
            const inputs = container.querySelectorAll('input, textarea');
            inputs.forEach(input => {
                input.addEventListener('change', () => saveCurrentAnswer());
            });

            // Update navigation buttons
            updateNavigationButtons();
            updateQuestionNavigation();
        }

        function saveCurrentAnswer() {
            if (!currentExam) return;

            const question = currentExam.questions[currentQuestionIndex];
            const container = document.getElementById('questionContent');
            
            let answer;
            
            switch(question.type) {
                case 'multiple-choice':
                    const selectedOption = container.querySelector('input[name="answer"]:checked');
                    answer = selectedOption ? parseInt(selectedOption.value) : null;
                    break;
                    
                case 'true-false':
                    const selectedTF = container.querySelector('input[name="answer"]:checked');
                    answer = selectedTF ? selectedTF.value === 'true' : null;
                    break;
                    
                case 'short-answer':
                case 'long-answer':
                    const textarea = container.querySelector('textarea[name="answer"]');
                    answer = textarea ? textarea.value.trim() : '';
                    break;
                    
                default:
                    answer = null;
            }
            
            if (answer !== null && answer !== '') {
                studentAnswers[question.id] = answer;
            } else {
                delete studentAnswers[question.id];
            }
            
            updateQuestionNavigation();
        }

        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prevQuestionBtn');
            const nextBtn = document.getElementById('nextQuestionBtn');
            
            prevBtn.disabled = currentQuestionIndex === 0;
            
            if (currentQuestionIndex === currentExam.questions.length - 1) {
                nextBtn.innerHTML = '<i class="fas fa-flag mr-2"></i>Finish';
                nextBtn.onclick = () => showSubmitConfirmation();
            } else {
                nextBtn.innerHTML = 'Next<i class="fas fa-arrow-right ml-2"></i>';
                nextBtn.onclick = () => nextQuestion();
            }
        }

        function updateQuestionNavigation() {
            const navButtons = document.querySelectorAll('#questionNavigation button');
            navButtons.forEach((btn, index) => {
                btn.className = 'w-8 h-8 rounded-full text-sm font-medium transition-colors ';
                
                if (index === currentQuestionIndex) {
                    btn.className += 'bg-blue-600 text-white';
                } else if (studentAnswers[currentExam.questions[index].id] !== undefined) {
                    btn.className += 'bg-green-100 text-green-800 border border-green-300';
                } else if (flaggedQuestions.has(currentExam.questions[index].id)) {
                    btn.className += 'bg-yellow-100 text-yellow-800 border border-yellow-300';
                } else {
                    btn.className += 'bg-gray-100 text-gray-600 border border-gray-300 hover:bg-gray-200';
                }
            });
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                saveCurrentAnswer();
                currentQuestionIndex--;
                showCurrentQuestion();
            }
        }

        function nextQuestion() {
            if (currentQuestionIndex < currentExam.questions.length - 1) {
                saveCurrentAnswer();
                currentQuestionIndex++;
                showCurrentQuestion();
            }
        }

        function goToQuestion(index) {
            if (index >= 0 && index < currentExam.questions.length) {
                saveCurrentAnswer();
                currentQuestionIndex = index;
                showCurrentQuestion();
            }
        }

        function flagQuestion() {
            const questionId = currentExam.questions[currentQuestionIndex].id;
            if (flaggedQuestions.has(questionId)) {
                flaggedQuestions.delete(questionId);
                showToast('Question unflagged', 'info');
            } else {
                flaggedQuestions.add(questionId);
                showToast('Question flagged for review', 'warning');
            }
            updateQuestionNavigation();
        }

        function showSubmitConfirmation() {
            const answeredQuestions = Object.keys(studentAnswers).length;
            const totalQuestions = currentExam.questions.length;
            const unansweredCount = totalQuestions - answeredQuestions;

            let warningText = '';
            if (unansweredCount > 0) {
                warningText = `<div class="bg-yellow-50 dark:bg-yellow-900 p-3 rounded-lg mb-4">
                    <p class="text-yellow-800 dark:text-yellow-200">
                        <i class="fas fa-exclamation-triangle mr-2"></i>
                        You have ${unansweredCount} unanswered question(s).
                    </p>
                </div>`;
            }

            showModal('Submit Examination', `
                <div class="text-center">
                    <h3 class="text-xl font-semibold mb-4">Are you ready to submit?</h3>
                    ${warningText}
                    <div class="grid grid-cols-2 gap-4 mb-4 text-sm">
                        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
                            <div class="text-2xl font-bold text-blue-600">${answeredQuestions}</div>
                            <div class="text-gray-600">Answered</div>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
                            <div class="text-2xl font-bold text-orange-600">${unansweredCount}</div>
                            <div class="text-gray-600">Unanswered</div>
                        </div>
                    </div>
                    <p class="text-gray-600">Once submitted, you cannot make any changes.</p>
                </div>
            `, [
                { text: 'Review Answers', action: () => {}, class: 'btn-secondary' },
                { text: 'Submit Exam', action: () => { submitExam(); }, class: 'btn-primary' }
            ]);
        }

        function submitExam() {
            if (!currentExam) return;

            // Stop timer
            if (examTimer) {
                clearInterval(examTimer);
            }

            // Calculate score (simplified)
            let score = 0;
            let totalPossible = 0;

            currentExam.questions.forEach(question => {
                totalPossible += question.points;
                const answer = studentAnswers[question.id];
                
                if (question.type === 'multiple-choice' && answer === question.correctAnswer) {
                    score += question.points;
                } else if (question.type === 'true-false' && answer === question.correctAnswer) {
                    score += question.points;
                }
                // For text answers, we'd need manual grading
            });

            const finalScore = Math.round((score / totalPossible) * 100);
            const grade = finalScore >= 90 ? 'A' : finalScore >= 80 ? 'B' : finalScore >= 70 ? 'C' : finalScore >= 60 ? 'D' : 'F';

            // Save result
            const result = {
                id: 'result_' + Date.now(),
                examId: currentExam.id,
                studentId: currentUser.id,
                studentName: currentUser.name,
                examTitle: currentExam.title,
                track: currentExam.track,
                score: finalScore,
                grade: grade,
                totalMarks: currentExam.totalMarks,
                date: new Date().toISOString(),
                securityViolations: 0,
                status: 'completed',
                duration: Math.round((Date.now() - examStartTime) / 60000),
                answers: studentAnswers,
                flaggedQuestions: Array.from(flaggedQuestions)
            };

            examData.results.push(result);
            localStorage.setItem('examSystemData', JSON.stringify(examData));

            // Hide timer
            document.getElementById('examTimer').classList.add('hidden');

            // Show results
            showExamComplete(result);
        }

        function autoSubmitExam() {
            showToast('Time expired! Exam submitted automatically.', 'warning');
            submitExam();
        }

        function showExamComplete(result) {
            showModal('Exam Completed', `
                <div class="text-center">
                    <div class="w-20 h-20 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-check text-3xl text-green-600"></i>
                    </div>
                    <h3 class="text-2xl font-semibold mb-2">Exam Submitted Successfully!</h3>
                    <p class="text-gray-600 mb-6">Your exam has been submitted and will be graded shortly.</p>
                    
                    <div class="grid grid-cols-2 gap-4 mb-6">
                        <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
                            <div class="text-3xl font-bold text-blue-600">${result.score}%</div>
                            <div class="text-sm text-gray-600">Your Score</div>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
                            <div class="text-3xl font-bold text-purple-600">${result.grade}</div>
                            <div class="text-sm text-gray-600">Grade</div>
                        </div>
                    </div>
                    
                    <div class="bg-blue-50 dark:bg-blue-900 p-4 rounded-lg">
                        <p class="text-sm text-blue-800 dark:text-blue-200">
                            <i class="fas fa-info-circle mr-2"></i>
                            Your result has been securely recorded using blockchain verification.
                        </p>
                    </div>
                </div>
            `, [
                { text: 'View Results', action: () => { showSection('exam-results'); }, class: 'btn-primary' }
            ]);

            // Reset exam state
            currentExam = null;
            currentQuestionIndex = 0;
            studentAnswers = {};
            flaggedQuestions = new Set();
            examStartTime = null;
        }

        // Expert exam creation functions
        function addQuestion() {
            showQuestionTypeModal();
        }

        function showQuestionTypeModal() {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 max-w-4xl w-full mx-4 max-h-90vh overflow-y-auto">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold">Select Question Type</h3>
                        <button onclick="this.closest('.fixed').remove()" class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        ${Object.entries(questionTypes).map(([type, config]) => `
                            <div class="question-type-card" onclick="selectQuestionType('${type}')">
                                <i class="${config.icon} text-3xl text-blue-600 mb-3"></i>
                                <h4 class="font-semibold mb-2">${config.name}</h4>
                                <p class="text-sm text-gray-600">${config.description}</p>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function selectQuestionType(type) {
            // Close modal
            document.querySelector('.fixed.inset-0').remove();
            
            // Add question to container
            const container = document.getElementById('questionsContainer');
            const questionId = 'question_' + Date.now();
            
            const questionDiv = document.createElement('div');
            questionDiv.className = 'card p-6 mb-4';
            questionDiv.dataset.questionId = questionId;
            questionDiv.dataset.questionType = type;
            
            questionDiv.innerHTML = createQuestionHTML(type, questionId);
            container.appendChild(questionDiv);
            
            showToast(`${questionTypes[type].name} question added`, 'success');
        }

        function createQuestionHTML(type, questionId) {
            const baseHTML = `
                <div class="flex justify-between items-start mb-4">
                    <h4 class="font-semibold text-lg">${questionTypes[type].name} Question</h4>
                    <button class="btn-danger text-sm px-3 py-1" onclick="removeQuestion('${questionId}')">
                        <i class="fas fa-trash mr-1"></i>Remove
                    </button>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">Question Text *</label>
                        <textarea class="input-field w-full" rows="3" placeholder="Enter your question" required></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Points *</label>
                        <input type="number" class="input-field w-full" placeholder="10" min="1" max="100" required>
                    </div>
                </div>
            `;

            let specificHTML = '';

            switch(type) {
                case 'multiple-choice':
                    specificHTML = `
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2">Options *</label>
                            <div class="space-y-2" id="options-${questionId}">
                                <div class="flex items-center space-x-2">
                                    <input type="radio" name="correct-${questionId}" value="0">
                                    <input type="text" class="input-field flex-1" placeholder="Option A" required>
                                    <button class="btn-danger text-sm px-2 py-1" onclick="removeOption(this)">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <input type="radio" name="correct-${questionId}" value="1">
                                    <input type="text" class="input-field flex-1" placeholder="Option B" required>
                                    <button class="btn-danger text-sm px-2 py-1" onclick="removeOption(this)">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                            <button class="btn-secondary text-sm mt-2" onclick="addOption('${questionId}')">
                                <i class="fas fa-plus mr-1"></i>Add Option
                            </button>
                            <p class="text-xs text-gray-500 mt-1">Select the radio button next to the correct answer</p>
                        </div>
                    `;
                    break;

                case 'true-false':
                    specificHTML = `
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2">Correct Answer *</label>
                            <div class="flex space-x-4">
                                <label class="flex items-center">
                                    <input type="radio" name="correct-${questionId}" value="true" class="mr-2">
                                    <span>True</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="correct-${questionId}" value="false" class="mr-2">
                                    <span>False</span>
                                </label>
                            </div>
                        </div>
                    `;
                    break;

                case 'short-answer':
                case 'long-answer':
                    specificHTML = `
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2">Sample Answer (Optional)</label>
                            <textarea class="input-field w-full" rows="${type === 'long-answer' ? 6 : 3}" placeholder="Provide a sample answer for reference"></textarea>
                        </div>
                    `;
                    break;

                case 'matching':
                    specificHTML = `
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2">Matching Pairs *</label>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <h5 class="font-medium mb-2">Column A</h5>
                                    <div id="columnA-${questionId}" class="space-y-2">
                                        <input type="text" class="input-field w-full" placeholder="Item 1" required>
                                        <input type="text" class="input-field w-full" placeholder="Item 2" required>
                                    </div>
                                </div>
                                <div>
                                    <h5 class="font-medium mb-2">Column B</h5>
                                    <div id="columnB-${questionId}" class="space-y-2">
                                        <input type="text" class="input-field w-full" placeholder="Match 1" required>
                                        <input type="text" class="input-field w-full" placeholder="Match 2" required>
                                    </div>
                                </div>
                            </div>
                            <button class="btn-secondary text-sm mt-2" onclick="addMatchingPair('${questionId}')">
                                <i class="fas fa-plus mr-1"></i>Add Pair
                            </button>
                        </div>
                    `;
                    break;

                case 'practical':
                    specificHTML = `
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2">Instructions</label>
                            <textarea class="input-field w-full" rows="4" placeholder="Provide detailed instructions for the practical exercise"></textarea>
                        </div>
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2">Expected Output/Solution</label>
                            <textarea class="input-field w-full" rows="6" placeholder="Describe the expected output or provide solution code"></textarea>
                        </div>
                    `;
                    break;
            }

            return baseHTML + specificHTML;
        }

        function removeQuestion(questionId) {
            const questionDiv = document.querySelector(`[data-question-id="${questionId}"]`);
            if (questionDiv) {
                questionDiv.remove();
                showToast('Question removed', 'info');
            }
        }

        function addOption(questionId) {
            const container = document.getElementById(`options-${questionId}`);
            const optionCount = container.children.length;
            const optionDiv = document.createElement('div');
            optionDiv.className = 'flex items-center space-x-2';
            optionDiv.innerHTML = `
                <input type="radio" name="correct-${questionId}" value="${optionCount}">
                <input type="text" class="input-field flex-1" placeholder="Option ${String.fromCharCode(65 + optionCount)}" required>
                <button class="btn-danger text-sm px-2 py-1" onclick="removeOption(this)">
                    <i class="fas fa-times"></i>
                </button>
            `;
            container.appendChild(optionDiv);
        }

        function removeOption(button) {
            button.parentElement.remove();
        }

        function addMatchingPair(questionId) {
            const columnA = document.getElementById(`columnA-${questionId}`);
            const columnB = document.getElementById(`columnB-${questionId}`);
            const pairCount = columnA.children.length + 1;

            const inputA = document.createElement('input');
            inputA.type = 'text';
            inputA.className = 'input-field w-full';
            inputA.placeholder = `Item ${pairCount}`;
            inputA.required = true;

            const inputB = document.createElement('input');
            inputB.type = 'text';
            inputB.className = 'input-field w-full';
            inputB.placeholder = `Match ${pairCount}`;
            inputB.required = true;

            columnA.appendChild(inputA);
            columnB.appendChild(inputB);
        }

        function saveExamDraft() {
            const formData = collectExamFormData();
            if (!formData) return;

            // Save to localStorage as draft
            const drafts = JSON.parse(localStorage.getItem('examDrafts') || '[]');
            const draftId = 'draft_' + Date.now();
            
            drafts.push({
                id: draftId,
                ...formData,
                status: 'draft',
                lastModified: new Date().toISOString()
            });

            localStorage.setItem('examDrafts', JSON.stringify(drafts));
            showToast('Exam saved as draft', 'success');
        }

        function previewExam() {
            const formData = collectExamFormData();
            if (!formData) return;

            // Show preview modal
            showModal('Exam Preview', `
                <div class="max-h-96 overflow-y-auto">
                    <h3 class="text-xl font-semibold mb-4">${formData.title}</h3>
                    <div class="grid grid-cols-2 gap-4 mb-4 text-sm">
                        <div><strong>Track:</strong> ${formData.track}</div>
                        <div><strong>Duration:</strong> ${formData.duration} minutes</div>
                        <div><strong>Total Marks:</strong> ${formData.totalMarks}</div>
                        <div><strong>Questions:</strong> ${formData.questions.length}</div>
                    </div>
                    <div class="mb-4">
                        <strong>Instructions:</strong>
                        <p class="text-gray-600 mt-1">${formData.instructions}</p>
                    </div>
                    <div>
                        <strong>Questions:</strong>
                        <ol class="mt-2 space-y-2">
                            ${formData.questions.map((q, i) => `
                                <li class="p-2 bg-gray-50 dark:bg-gray-700 rounded">
                                    <strong>${i + 1}.</strong> ${q.question} 
                                    <span class="text-sm text-gray-500">(${q.points} points)</span>
                                </li>
                            `).join('')}
                        </ol>
                    </div>
                </div>
            `, [
                { text: 'Close', action: () => {}, class: 'btn-secondary' }
            ]);
        }

        function collectExamFormData() {
            const form = document.getElementById('createExamForm');
            if (!form) return null;

            const formData = new FormData(form);
            
            const examData = {
                title: document.getElementById('examTitle').value,
                track: document.getElementById('examTrack').value,
                duration: parseInt(document.getElementById('examDuration').value),
                totalMarks: parseInt(document.getElementById('examMarks').value),
                startDate: document.getElementById('examStartDate').value,
                endDate: document.getElementById('examEndDate').value,
                instructions: document.getElementById('examInstructions').value,
                aiProctoring: document.getElementById('enableAIProcotring').checked,
                blockchainVerification: document.getElementById('enableBlockchain').checked,
                shuffleQuestions: document.getElementById('shuffleQuestions').checked,
                allowRetake: document.getElementById('allowRetake').checked,
                questions: []
            };

            // Validate required fields
            if (!examData.title || !examData.track || !examData.duration || !examData.totalMarks) {
                showToast('Please fill in all required fields', 'error');
                return null;
            }

            // Collect questions
            const questionDivs = document.querySelectorAll('#questionsContainer .card');
            questionDivs.forEach((div, index) => {
                const question = collectQuestionData(div, index);
                if (question) {
                    examData.questions.push(question);
                }
            });

            if (examData.questions.length === 0) {
                showToast('Please add at least one question', 'error');
                return null;
            }

            return examData;
        }

        function collectQuestionData(questionDiv, index) {
            const type = questionDiv.dataset.questionType;
            const questionText = questionDiv.querySelector('textarea').value;
            const points = parseInt(questionDiv.querySelector('input[type="number"]').value);

            if (!questionText || !points) {
                showToast(`Question ${index + 1} is incomplete`, 'error');
                return null;
            }

            const question = {
                id: 'q' + (index + 1),
                type: type,
                question: questionText,
                points: points
            };

            switch(type) {
                case 'multiple-choice':
                    const options = Array.from(questionDiv.querySelectorAll('#options-' + questionDiv.dataset.questionId + ' input[type="text"]'))
                        .map(input => input.value)
                        .filter(value => value.trim());
                    
                    const correctAnswer = questionDiv.querySelector('input[type="radio"]:checked');
                    
                    if (options.length < 2) {
                        showToast(`Question ${index + 1} needs at least 2 options`, 'error');
                        return null;
                    }
                    
                    if (!correctAnswer) {
                        showToast(`Question ${index + 1} needs a correct answer selected`, 'error');
                        return null;
                    }

                    question.options = options;
                    question.correctAnswer = parseInt(correctAnswer.value);
                    break;

                case 'true-false':
                    const tfCorrect = questionDiv.querySelector('input[type="radio"]:checked');
                    if (!tfCorrect) {
                        showToast(`Question ${index + 1} needs a correct answer selected`, 'error');
                        return null;
                    }
                    question.correctAnswer = tfCorrect.value === 'true';
                    break;

                case 'short-answer':
                case 'long-answer':
                    const sampleAnswer = questionDiv.querySelectorAll('textarea')[1]?.value;
                    if (sampleAnswer) {
                        question.sampleAnswer = sampleAnswer;
                    }
                    break;

                case 'matching':
                    const columnA = Array.from(questionDiv.querySelectorAll('#columnA-' + questionDiv.dataset.questionId + ' input'))
                        .map(input => input.value)
                        .filter(value => value.trim());
                    const columnB = Array.from(questionDiv.querySelectorAll('#columnB-' + questionDiv.dataset.questionId + ' input'))
                        .map(input => input.value)
                        .filter(value => value.trim());
                    
                    if (columnA.length !== columnB.length || columnA.length < 2) {
                        showToast(`Question ${index + 1} needs at least 2 matching pairs`, 'error');
                        return null;
                    }

                    question.columnA = columnA;
                    question.columnB = columnB;
                    break;

                case 'practical':
                    const instructions = questionDiv.querySelectorAll('textarea')[1]?.value;
                    const expectedOutput = questionDiv.querySelectorAll('textarea')[2]?.value;
                    
                    question.instructions = instructions;
                    question.expectedOutput = expectedOutput;
                    break;
            }

            return question;
        }

        function resetForm() {
            if (confirm('Are you sure you want to reset the form? All data will be lost.')) {
                document.getElementById('createExamForm').reset();
                document.getElementById('questionsContainer').innerHTML = '';
                showToast('Form reset successfully', 'info');
            }
        }

        // Initialize sidebar and navigation
        function initializeSidebar() {
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', () => {
                    if (item.dataset.section) {
                        document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
                        item.classList.add('active');
                        showSection(item.dataset.section);
                    }
                });
            });

            // Mobile sidebar controls
            document.getElementById('openSidebar')?.addEventListener('click', () => {
                document.getElementById('sidebar').classList.remove('mobile-hidden');
            });

            document.getElementById('closeSidebar')?.addEventListener('click', () => {
                document.getElementById('sidebar').classList.add('mobile-hidden');
            });

            // Toggle sidebar
            document.getElementById('toggleSidebar')?.addEventListener('click', () => {
                const sidebar = document.getElementById('sidebar');
                const mainContent = document.getElementById('mainContent');

                sidebar.classList.toggle('collapsed');
                mainContent.classList.toggle('sidebar-collapsed');
            });

            // Back to dashboard
            document.getElementById('backToDashboard')?.addEventListener('click', () => {
                // Navigate to appropriate dashboard based on user role
                const dashboardUrl = {
                    'student': 'dashboard_student.html',
                    'expert': 'dashboard_expert.html',
                    'administrator': 'dashboard_administrator.html'
                }[currentUser.role] || 'index.html';
                
                window.location.href = dashboardUrl;
            });
        }

        // Dark mode functionality
        function initializeDarkMode() {
            const darkModeToggle = document.getElementById('darkModeToggle');
            const darkModeIcon = document.getElementById('darkModeIcon');

            // Check system preference
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.documentElement.classList.add('dark');
                if (darkModeIcon) darkModeIcon.className = 'fas fa-sun';
            }

            // Listen for system theme changes
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
                if (event.matches) {
                    document.documentElement.classList.add('dark');
                    if (darkModeIcon) darkModeIcon.className = 'fas fa-sun';
                } else {
                    document.documentElement.classList.remove('dark');
                    if (darkModeIcon) darkModeIcon.className = 'fas fa-moon';
                }
            });

            if (darkModeToggle) {
                darkModeToggle.addEventListener('click', () => {
                    const isDark = document.documentElement.classList.toggle('dark');
                    if (darkModeIcon) {
                        darkModeIcon.className = isDark ? 'fas fa-sun' : 'fas fa-moon';
                    }
                    showToast(`${isDark ? 'Dark' : 'Light'} mode activated`, 'success');
                });
            }
        }

        // Fullscreen functionality
        function initializeFullscreen() {
            const fullscreenToggle = document.getElementById('fullscreenToggle');
            const fullscreenIcon = document.getElementById('fullscreenIcon');

            if (fullscreenToggle) {
                fullscreenToggle.addEventListener('click', () => {
                    if (!document.fullscreenElement) {
                        document.documentElement.requestFullscreen();
                        fullscreenIcon.className = 'fas fa-compress';
                        showToast('Entered fullscreen mode', 'info');
                    } else {
                        document.exitFullscreen();
                        fullscreenIcon.className = 'fas fa-expand';
                        showToast('Exited fullscreen mode', 'info');
                    }
                });
            }

            // Listen for fullscreen changes
            document.addEventListener('fullscreenchange', () => {
                if (fullscreenIcon) {
                    fullscreenIcon.className = document.fullscreenElement ? 'fas fa-compress' : 'fas fa-expand';
                }
            });
        }

        // Notification management
        function initializeNotifications() {
            document.getElementById('notificationBtn')?.addEventListener('click', () => {
                const panel = document.getElementById('notificationPanel');
                panel.classList.toggle('show');
            });

            // Load notifications
            loadNotificationPanel();
        }

        function loadNotificationPanel() {
            const container = document.getElementById('notificationsList');
            if (!container) return;

            container.innerHTML = '';

            if (notifications.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-sm">No notifications</p>';
                return;
            }

            notifications.slice(0, 5).forEach(notification => {
                const notifDiv = document.createElement('div');
                notifDiv.className = `notification-item ${notification.type} ${!notification.read ? 'font-semibold' : ''}`;
                notifDiv.innerHTML = `
                    <h5 class="font-medium text-sm">${notification.title}</h5>
                    <p class="text-xs mt-1">${notification.message}</p>
                    <p class="text-xs text-gray-500 mt-1">${new Date(notification.time).toLocaleString()}</p>
                `;
                container.appendChild(notifDiv);
            });
        }

        function markAllNotificationsRead() {
            notifications.forEach(n => n.read = true);
            localStorage.setItem('examNotifications', JSON.stringify(notifications));
            updateNotificationCount();
            loadNotificationPanel();
            showToast('All notifications marked as read', 'success');
        }

        function markNotificationRead(notificationId) {
            const notification = notifications.find(n => n.id === notificationId);
            if (notification) {
                notification.read = true;
                localStorage.setItem('examNotifications', JSON.stringify(notifications));
                updateNotificationCount();
                loadNotificationsList();
                showToast('Notification marked as read', 'info');
            }
        }

        // Real-time monitoring simulation
        function startRealTimeMonitoring() {
            // Simulate real-time updates every 30 seconds
            setInterval(() => {
                // Update CPU usage
                const cpuUsage = Math.floor(Math.random() * 30) + 20;
                document.getElementById('cpuUsage').textContent = cpuUsage + '%';
                document.querySelector('[style*="width: 24%"]').style.width = cpuUsage + '%';

                // Update memory usage
                const memoryUsage = Math.floor(Math.random() * 20) + 50;
                document.getElementById('memoryUsage').textContent = memoryUsage + '%';
                document.querySelector('[style*="width: 62%"]').style.width = memoryUsage + '%';

                // Update network traffic
                const networkTraffic = (Math.random() * 2 + 0.5).toFixed(1);
                document.getElementById('networkTraffic').textContent = networkTraffic + ' Gbps';
            }, 30000);
        }

        // Utility functions
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.innerHTML = `
                <div class="flex items-center justify-between">
                    <span>${message}</span>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-white hover:text-gray-200">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;

            document.body.appendChild(toast);
            
            // Animate in
            requestAnimationFrame(() => {
                toast.classList.add('show');
            });

            // Auto remove
            setTimeout(() => {
                if (toast.parentElement) {
                    toast.classList.remove('show');
                    setTimeout(() => toast.remove(), 300);
                }
            }, 5000);
        }

        function showModal(title, content, buttons = []) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
            
            const defaultButtons = buttons.length > 0 ? buttons : [
                { text: 'Close', action: () => modal.remove(), class: 'btn-secondary' }
            ];

            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden">
                    <div class="p-6 border-b border-gray-200 dark:border-gray-700">
                        <h3 class="text-xl font-bold text-gray-900 dark:text-white">${title}</h3>
                    </div>
                    <div class="p-6 max-h-96 overflow-y-auto">
                        ${content}
                    </div>
                    <div class="p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end space-x-3">
                        ${defaultButtons.map(btn => 
                            `<button class="${btn.class || 'btn-primary'} px-6 py-2" onclick="this.closest('.fixed').remove(); (${btn.action.toString()})();">${btn.text}</button>`
                        ).join('')}
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close on backdrop click
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });

            return modal;
        }

        // Placeholder functions for future implementation
        function previewExamForStudent(examId) {
            showToast('Exam preview will be implemented', 'info');
        }

        function startPracticeTest(testId) {
            showToast('Practice test will start soon', 'info');
        }

        function viewDetailedResult(resultId) {
            showToast('Detailed result view will be implemented', 'info');
        }

        function exportHistory() {
            showToast('Export functionality will be implemented', 'info');
        }

        function editExam(examId) {
            showToast('Exam editing will be implemented', 'info');
        }

        function viewExamAnalytics(examId) {
            showToast('Exam analytics will be implemented', 'info');
        }

        function duplicateExam(examId) {
            showToast('Exam duplication will be implemented', 'info');
        }

        function activateExam(examId) {
            showToast('Exam activated', 'success');
        }

        function deactivateExam(examId) {
            showToast('Exam deactivated', 'warning');
        }

        function gradeSubmission(submissionId) {
            showToast('Grading interface will be implemented', 'info');
        }

        function viewSubmissionDetails(submissionId) {
            showToast('Submission details will be implemented', 'info');
        }

        function enableAIGrading() {
            showToast('AI grading enabled', 'success');
        }

        function displayExamAnalytics(examId) {
            showToast('Loading analytics for exam: ' + examId, 'info');
        }

        function exportAnalytics() {
            showToast('Analytics export will be implemented', 'info');
        }

        function uploadMaterial() {
            showToast('Material upload will be implemented', 'info');
        }

        function downloadMaterial(materialId) {
            showToast('Material download will be implemented', 'info');
        }

        function deleteMaterial(materialId) {
            showToast('Material deleted', 'warning');
        }

        function monitorSession(studentName) {
            showToast('Monitoring session for ' + studentName, 'info');
        }

        function toggleAIProctoring() {
            showToast('AI proctoring settings updated', 'info');
        }

        function updateAISettings() {
            showToast('AI settings updated successfully', 'success');
        }

        function investigateDetection(studentName) {
            showToast('Investigating detection for ' + studentName, 'info');
        }

        function createAnnouncement() {
            const form = document.getElementById('announcementForm');
            form.style.display = form.style.display === 'none' ? 'block' : 'none';
        }

        function cancelAnnouncement() {
            document.getElementById('announcementForm').style.display = 'none';
        }

        function publishAnnouncement() {
            const title = document.getElementById('announcementTitle').value;
            const message = document.getElementById('announcementMessage').value;
            const priority = document.getElementById('announcementPriority').value;
            const target = document.getElementById('announcementTarget').value;
            const type = document.getElementById('announcementType').value;

            if (!title || !message) {
                showToast('Please fill in title and message', 'error');
                return;
            }

            const announcement = {
                id: 'ann_' + Date.now(),
                title: title,
                message: message,
                priority: priority,
                targetRole: target,
                type: type,
                date: new Date(),
                author: currentUser.id
            };

            examData.announcements.push(announcement);
            localStorage.setItem('examSystemData', JSON.stringify(examData));

            // Clear form
            document.getElementById('announcementTitle').value = '';
            document.getElementById('announcementMessage').value = '';
            document.getElementById('announcementForm').style.display = 'none';

            loadAnnouncements();
            showToast('Announcement published successfully', 'success');
        }

        function editAnnouncement(announcementId) {
            showToast('Announcement editing will be implemented', 'info');
        }

        function deleteAnnouncement(announcementId) {
            if (confirm('Are you sure you want to delete this announcement?')) {
                examData.announcements = examData.announcements.filter(a => a.id !== announcementId);
                localStorage.setItem('examSystemData', JSON.stringify(examData));
                loadAnnouncements();
                showToast('Announcement deleted', 'warning');
            }
        }

        function refreshAvailableExams() {
            loadAvailableExams();
            showToast('Exams refreshed', 'info');
        }

        // Form submission handler
        document.addEventListener('DOMContentLoaded', function() {
            // Create exam form submission
            const createExamForm = document.getElementById('createExamForm');
            if (createExamForm) {
                createExamForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const formData = collectExamFormData();
                    if (!formData) return;

                    // Add to exam data
                    const newExam = {
                        id: 'exam_' + Date.now(),
                        ...formData,
                        creator: currentUser.id,
                        status: 'active',
                        createdAt: new Date().toISOString()
                    };

                    examData.exams.push(newExam);
                    localStorage.setItem('examSystemData', JSON.stringify(examData));

                    // Reset form
                    createExamForm.reset();
                    document.getElementById('questionsContainer').innerHTML = '';

                    showToast('Exam published successfully!', 'success');
                    
                    // Navigate to manage exams
                    setTimeout(() => {
                        showSection('manage-exams');
                    }, 1500);
                });
            }

            // Issue report form submission
            const issueReportForm = document.getElementById('issueReportForm');
            if (issueReportForm) {
                issueReportForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const formData = new FormData(this);
                    
                    showToast('Issue report submitted successfully', 'success');
                    this.reset();
                });
            }

            // File upload handling
            const fileInput = document.getElementById('fileInput');
            const fileUploadArea = document.getElementById('fileUploadArea');
            
            if (fileUploadArea && fileInput) {
                fileUploadArea.addEventListener('click', () => fileInput.click());
                
                fileUploadArea.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    fileUploadArea.classList.add('dragover');
                });
                
                fileUploadArea.addEventListener('dragleave', () => {
                    fileUploadArea.classList.remove('dragover');
                });
                
                fileUploadArea.addEventListener('drop', (e) => {
                    e.preventDefault();
                    fileUploadArea.classList.remove('dragover');
                    const files = e.dataTransfer.files;
                    handleFileUpload(files);
                });
                
                fileInput.addEventListener('change', (e) => {
                    handleFileUpload(e.target.files);
                });
            }
        });

        function handleFileUpload(files) {
            Array.from(files).forEach(file => {
                if (file.size > 50 * 1024 * 1024) { // 50MB limit
                    showToast(`File ${file.name} is too large (max 50MB)`, 'error');
                    return;
                }
                
                showToast(`File ${file.name} ready for upload`, 'info');
            });
        }

        console.log('🚀 Advanced Exam System fully loaded and operational!');
    </script>
</body>

</html>
